import numpy as np
from numpy import sin, cos


def CarregamentoMaximo(posicao):
    a = 0
    b = 10
    while b - a > 0.000000001:
        c = 0.5 * (a + b)
        valor_c = FluxoDeCarga(c, posicao)
        if valor_c:
            a = c
        else:
            b = c
    return a


def FluxoDeCarga(alpha, posicao, Qg1=0, Qg2=0, Qg3=0, tipo=0):
    if tipo == 0:
        x = np.array([0, 0, 0, 0, 0, 1, 1, 1])
    elif tipo == 1 or tipo == 2 or tipo == 3:
        x = np.array([0, 0, 0, 0, 0, 1, 1, 1, 1])
    elif tipo == 12 or tipo == 13 or tipo == 23:
        x = np.array([0, 0, 0, 0, 0, 1, 1, 1, 1, 1])
    else:
        x = np.array([0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1])
    equacionamento = Equacoes(x, posicao, alpha, tipo, Qg1, Qg2, Qg3)
    B = equacionamento[0]
    A = equacionamento[1]
    k = 0
    while max(abs(B)) > 0.0001:
        if k > 50:
            return False
        Δx = np.linalg.solve(A, -B)
        x = x + Δx
        equacionamento = Equacoes(x, posicao, alpha, tipo, Qg1, Qg2, Qg3)
        B = equacionamento[0]
        A = equacionamento[1]
        k += 1
    # Theta2 = x[0]
    # Theta3 = x[1]
    # Theta4 = x[2]
    # Theta5 = x[3]
    # Theta6 = x[4]
    # V4 = x[5]
    # V5 = x[6]
    # V6 = x[7]
    θ = np.array([0, x[0], x[1], x[2], x[3], x[4]])
    if tipo == 0:
        V = np.array([posicao[0], posicao[1], posicao[2], x[5], x[6], x[7]])
    elif tipo == 1:
        V = np.array([x[5], posicao[1], posicao[2], x[6], x[7], x[8]])
    elif tipo == 2:
        V = np.array([posicao[0], x[5], posicao[2], x[6], x[7], x[8]])
    elif tipo == 3:
        V = np.array([posicao[0], posicao[1], x[5], x[6], x[7], x[8]])
    elif tipo == 12:
        V = np.array([x[5], x[6], posicao[2], x[7], x[8], x[9]])
    elif tipo == 13:
        V = np.array([x[5], posicao[1], x[6], x[7], x[8], x[9]])
    elif tipo == 23:
        V = np.array([posicao[0], x[5], x[6], x[7], x[8], x[9]])
    else:
        V = np.array([x[5], x[6], x[7], x[8], x[9], x[10]])
    Qk = np.zeros(3)
    gbus = np.array([[4.00634610690749, -2.00000000000000, 0, -1.17647058823529, -0.829875518672199, 0], [-2.00000000000000, 9.32825081377420, -0.769230769230769, -4.00000000000000, -1.00000000000000, -1.55902004454343], [0, -0.769230769230769, 4.15572232645403, 0, -1.46341463414634, -1.92307692307692], [-1.17647058823529, -4.00000000000000, 0, 6.17647058823529, -1.00000000000000, 0], [-0.829875518672199, -1.00000000000000, -1.46341463414634, -1.00000000000000, 5.29329015281854, -1.00000000000000], [0, -1.55902004454343, -1.92307692307692, 0, -1.00000000000000, 4.48209696762035]])
    bbus = np.array([[-11.7479155479619, 4.00000000000000, 0, 4.70588235294118, 3.11203319502075, 0], [4.00000000000000, -23.1954968305636, 3.84615384615385, 8.00000000000000, 3.00000000000000, 4.45434298440980], [0, 3.84615384615385, -16.5672701688555, 0, 3.17073170731707, 9.61538461538461], [4.70588235294118, 8.00000000000000, 0, -14.6358823529412, 2.00000000000000, 0], [3.11203319502075, 3.00000000000000, 3.17073170731707, 2.00000000000000, -14.1377649023378, 3.00000000000000], [0, 4.45434298440980, 9.61538461538461, 0, 3.00000000000000, -17.0047275997944]])
    for i in range(0, 3):
        expressao = 0
        for j in range(0, 6):
            expressao += V[i] * V[j] * (gbus[i, j] * np.sin(θ[i] - θ[j]) - bbus[i, j] * np.cos(θ[i] - θ[j]))
            Qk[i] = expressao
    if round(max(abs(Qk)), 3) > 1.5:
        violacoes = [False, False, False]
        novo_Qg = [0, 0, 0]
        for i in range(0, 3):
            if round(abs(float(Qk[i])), 3) >= 1.5:
                violacoes[i] = True
                if round(float(Qk[i]), 3) >= 1.5:
                    novo_Qg[i] = 1.5
                if round(float(Qk[i]), 3) <= -1.5:
                    novo_Qg[i] = -1.5
        if violacoes == [True, False, False]:
            novo_tipo = 1
        elif violacoes == [False, True, False]:
            novo_tipo = 2
        elif violacoes == [False, False, True]:
            novo_tipo = 3
        elif violacoes == [True, True, False]:
            novo_tipo = 12
        elif violacoes == [True, False, True]:
            novo_tipo = 13
        elif violacoes == [False, True, True]:
            novo_tipo = 23
        else:
            return False
        return FluxoDeCarga(alpha, posicao, novo_Qg[0], novo_Qg[1], novo_Qg[2], novo_tipo)
    else:
        return True


def Equacoes(x, posicao, alpha, tipo, Qg1, Qg2, Qg3):
    if len(posicao) == 3:
        Pg2 = 1.4
        Pg3 = 0.6
    else:
        Pg2 = posicao[3]
        Pg3 = posicao[4]
    if tipo == 0:
        V1 = posicao[0]
        V2 = posicao[1]
        V3 = posicao[2]
        θ2 = x[0]
        θ3 = x[1]
        θ4 = x[2]
        θ5 = x[3]
        θ6 = x[4]
        V4 = x[5]
        V5 = x[6]
        V6 = x[7]
        ΔP2 = Pg2*(alpha + 1) - V1*V2*(4.0*sin(θ2) - 2.0*cos(θ2)) - 9.3282508137742*V2**2 - V2*V3*(3.84615384615385*sin(θ2 - θ3) - 0.769230769230769*cos(θ2 - θ3)) - V2*V4*(8.0*sin(θ2 - θ4) - 4.0*cos(θ2 - θ4)) - V2*V5*(3.0*sin(θ2 - θ5) - 1.0*cos(θ2 - θ5)) - V2*V6*(4.4543429844098*sin(θ2 - θ6) - 1.55902004454343*cos(θ2 - θ6))
        ΔP3 = Pg3*(alpha + 1) - V2*V3*(-3.84615384615385*sin(θ2 - θ3) - 0.769230769230769*cos(θ2 - θ3)) - 4.15572232645403*V3**2 - V3*V5*(3.17073170731707*sin(θ3 - θ5) - 1.46341463414634*cos(θ3 - θ5)) - V3*V6*(9.61538461538461*sin(θ3 - θ6) - 1.92307692307692*cos(θ3 - θ6))
        ΔP4 = -V1*V4*(4.70588235294118*sin(θ4) - 1.17647058823529*cos(θ4)) - V2*V4*(-8.0*sin(θ2 - θ4) - 4.0*cos(θ2 - θ4)) - 6.17647058823529*V4**2 - V4*V5*(2.0*sin(θ4 - θ5) - 1.0*cos(θ4 - θ5)) - 0.9*alpha - 0.9
        ΔP5 = -V1*V5*(3.11203319502075*sin(θ5) - 0.829875518672199*cos(θ5)) - V2*V5*(-3.0*sin(θ2 - θ5) - 1.0*cos(θ2 - θ5)) - V3*V5*(-3.17073170731707*sin(θ3 - θ5) - 1.46341463414634*cos(θ3 - θ5)) - V4*V5*(-2.0*sin(θ4 - θ5) - 1.0*cos(θ4 - θ5)) - 5.29329015281854*V5**2 - V5*V6*(3.0*sin(θ5 - θ6) - 1.0*cos(θ5 - θ6)) - alpha - 1
        ΔP6 = -V2*V6*(-4.4543429844098*sin(θ2 - θ6) - 1.55902004454343*cos(θ2 - θ6)) - V3*V6*(-9.61538461538461*sin(θ3 - θ6) - 1.92307692307692*cos(θ3 - θ6)) - V5*V6*(-3.0*sin(θ5 - θ6) - 1.0*cos(θ5 - θ6)) - 4.48209696762035*V6**2 - 0.9*alpha - 0.9
        ΔQ4 = -V1*V4*(-1.17647058823529*sin(θ4) - 4.70588235294118*cos(θ4)) - V2*V4*(4.0*sin(θ2 - θ4) - 8.0*cos(θ2 - θ4)) - 14.6358823529412*V4**2 - V4*V5*(-1.0*sin(θ4 - θ5) - 2.0*cos(θ4 - θ5)) - 0.6*alpha - 0.6
        ΔQ5 = -V1*V5*(-0.829875518672199*sin(θ5) - 3.11203319502075*cos(θ5)) - V2*V5*(1.0*sin(θ2 - θ5) - 3.0*cos(θ2 - θ5)) - V3*V5*(1.46341463414634*sin(θ3 - θ5) - 3.17073170731707*cos(θ3 - θ5)) - V4*V5*(1.0*sin(θ4 - θ5) - 2.0*cos(θ4 - θ5)) - 14.1377649023378*V5**2 - V5*V6*(-1.0*sin(θ5 - θ6) - 3.0*cos(θ5 - θ6)) - 0.7*alpha - 0.7
        ΔQ6 = -V2*V6*(1.55902004454343*sin(θ2 - θ6) - 4.4543429844098*cos(θ2 - θ6)) - V3*V6*(1.92307692307692*sin(θ3 - θ6) - 9.61538461538461*cos(θ3 - θ6)) - V5*V6*(1.0*sin(θ5 - θ6) - 3.0*cos(θ5 - θ6)) - 17.0047275997944*V6**2 - 0.6*alpha - 0.6
        B = np.array([ΔP2, ΔP3, ΔP4, ΔP5, ΔP6, ΔQ4, ΔQ5, ΔQ6])
        A = np.array([[-V1*V2*(2.0*sin(θ2) + 4.0*cos(θ2)) - V2*V3*(0.769230769230769*sin(θ2 - θ3) + 3.84615384615385*cos(θ2 - θ3)) - V2*V4*(4.0*sin(θ2 - θ4) + 8.0*cos(θ2 - θ4)) - V2*V5*(1.0*sin(θ2 - θ5) + 3.0*cos(θ2 - θ5)) - V2*V6*(1.55902004454343*sin(θ2 - θ6) + 4.4543429844098*cos(θ2 - θ6)), -V2*V3*(-0.769230769230769*sin(θ2 - θ3) - 3.84615384615385*cos(θ2 - θ3)), -V2*V4*(-4.0*sin(θ2 - θ4) - 8.0*cos(θ2 - θ4)), -V2*V5*(-1.0*sin(θ2 - θ5) - 3.0*cos(θ2 - θ5)), -V2*V6*(-1.55902004454343*sin(θ2 - θ6) - 4.4543429844098*cos(θ2 - θ6)), -V2*(8.0*sin(θ2 - θ4) - 4.0*cos(θ2 - θ4)), -V2*(3.0*sin(θ2 - θ5) - 1.0*cos(θ2 - θ5)), -V2*(4.4543429844098*sin(θ2 - θ6) - 1.55902004454343*cos(θ2 - θ6))], [-V2*V3*(0.769230769230769*sin(θ2 - θ3) - 3.84615384615385*cos(θ2 - θ3)), -V2*V3*(-0.769230769230769*sin(θ2 - θ3) + 3.84615384615385*cos(θ2 - θ3)) - V3*V5*(1.46341463414634*sin(θ3 - θ5) + 3.17073170731707*cos(θ3 - θ5)) - V3*V6*(1.92307692307692*sin(θ3 - θ6) + 9.61538461538461*cos(θ3 - θ6)), 0, -V3*V5*(-1.46341463414634*sin(θ3 - θ5) - 3.17073170731707*cos(θ3 - θ5)), -V3*V6*(-1.92307692307692*sin(θ3 - θ6) - 9.61538461538461*cos(θ3 - θ6)), 0, -V3*(3.17073170731707*sin(θ3 - θ5) - 1.46341463414634*cos(θ3 - θ5)), -V3*(9.61538461538461*sin(θ3 - θ6) - 1.92307692307692*cos(θ3 - θ6))], [-V2*V4*(4.0*sin(θ2 - θ4) - 8.0*cos(θ2 - θ4)), 0, -V1*V4*(1.17647058823529*sin(θ4) + 4.70588235294118*cos(θ4)) - V2*V4*(-4.0*sin(θ2 - θ4) + 8.0*cos(θ2 - θ4)) - V4*V5*(1.0*sin(θ4 - θ5) + 2.0*cos(θ4 - θ5)), -V4*V5*(-1.0*sin(θ4 - θ5) - 2.0*cos(θ4 - θ5)), 0, -V1*(4.70588235294118*sin(θ4) - 1.17647058823529*cos(θ4)) - V2*(-8.0*sin(θ2 - θ4) - 4.0*cos(θ2 - θ4)) - 12.3529411764706*V4 - V5*(2.0*sin(θ4 - θ5) - 1.0*cos(θ4 - θ5)), -V4*(2.0*sin(θ4 - θ5) - 1.0*cos(θ4 - θ5)), 0], [-V2*V5*(1.0*sin(θ2 - θ5) - 3.0*cos(θ2 - θ5)), -V3*V5*(1.46341463414634*sin(θ3 - θ5) - 3.17073170731707*cos(θ3 - θ5)), -V4*V5*(1.0*sin(θ4 - θ5) - 2.0*cos(θ4 - θ5)), -V1*V5*(0.829875518672199*sin(θ5) + 3.11203319502075*cos(θ5)) - V2*V5*(-1.0*sin(θ2 - θ5) + 3.0*cos(θ2 - θ5)) - V3*V5*(-1.46341463414634*sin(θ3 - θ5) + 3.17073170731707*cos(θ3 - θ5)) - V4*V5*(-1.0*sin(θ4 - θ5) + 2.0*cos(θ4 - θ5)) - V5*V6*(1.0*sin(θ5 - θ6) + 3.0*cos(θ5 - θ6)), -V5*V6*(-1.0*sin(θ5 - θ6) - 3.0*cos(θ5 - θ6)), -V5*(-2.0*sin(θ4 - θ5) - 1.0*cos(θ4 - θ5)), -V1*(3.11203319502075*sin(θ5) - 0.829875518672199*cos(θ5)) - V2*(-3.0*sin(θ2 - θ5) - 1.0*cos(θ2 - θ5)) - V3*(-3.17073170731707*sin(θ3 - θ5) - 1.46341463414634*cos(θ3 - θ5)) - V4*(-2.0*sin(θ4 - θ5) - 1.0*cos(θ4 - θ5)) - 10.5865803056371*V5 - V6*(3.0*sin(θ5 - θ6) - 1.0*cos(θ5 - θ6)), -V5*(3.0*sin(θ5 - θ6) - 1.0*cos(θ5 - θ6))], [-V2*V6*(1.55902004454343*sin(θ2 - θ6) - 4.4543429844098*cos(θ2 - θ6)), -V3*V6*(1.92307692307692*sin(θ3 - θ6) - 9.61538461538461*cos(θ3 - θ6)), 0, -V5*V6*(1.0*sin(θ5 - θ6) - 3.0*cos(θ5 - θ6)), -V2*V6*(-1.55902004454343*sin(θ2 - θ6) + 4.4543429844098*cos(θ2 - θ6)) - V3*V6*(-1.92307692307692*sin(θ3 - θ6) + 9.61538461538461*cos(θ3 - θ6)) - V5*V6*(-1.0*sin(θ5 - θ6) + 3.0*cos(θ5 - θ6)), 0, -V6*(-3.0*sin(θ5 - θ6) - 1.0*cos(θ5 - θ6)), -V2*(-4.4543429844098*sin(θ2 - θ6) - 1.55902004454343*cos(θ2 - θ6)) - V3*(-9.61538461538461*sin(θ3 - θ6) - 1.92307692307692*cos(θ3 - θ6)) - V5*(-3.0*sin(θ5 - θ6) - 1.0*cos(θ5 - θ6)) - 8.96419393524071*V6], [-V2*V4*(8.0*sin(θ2 - θ4) + 4.0*cos(θ2 - θ4)), 0, -V1*V4*(4.70588235294118*sin(θ4) - 1.17647058823529*cos(θ4)) - V2*V4*(-8.0*sin(θ2 - θ4) - 4.0*cos(θ2 - θ4)) - V4*V5*(2.0*sin(θ4 - θ5) - 1.0*cos(θ4 - θ5)), -V4*V5*(-2.0*sin(θ4 - θ5) + 1.0*cos(θ4 - θ5)), 0, -V1*(-1.17647058823529*sin(θ4) - 4.70588235294118*cos(θ4)) - V2*(4.0*sin(θ2 - θ4) - 8.0*cos(θ2 - θ4)) - 29.2717647058824*V4 - V5*(-1.0*sin(θ4 - θ5) - 2.0*cos(θ4 - θ5)), -V4*(-1.0*sin(θ4 - θ5) - 2.0*cos(θ4 - θ5)), 0], [-V2*V5*(3.0*sin(θ2 - θ5) + 1.0*cos(θ2 - θ5)), -V3*V5*(3.17073170731707*sin(θ3 - θ5) + 1.46341463414634*cos(θ3 - θ5)), -V4*V5*(2.0*sin(θ4 - θ5) + 1.0*cos(θ4 - θ5)), -V1*V5*(3.11203319502075*sin(θ5) - 0.829875518672199*cos(θ5)) - V2*V5*(-3.0*sin(θ2 - θ5) - 1.0*cos(θ2 - θ5)) - V3*V5*(-3.17073170731707*sin(θ3 - θ5) - 1.46341463414634*cos(θ3 - θ5)) - V4*V5*(-2.0*sin(θ4 - θ5) - 1.0*cos(θ4 - θ5)) - V5*V6*(3.0*sin(θ5 - θ6) - 1.0*cos(θ5 - θ6)), -V5*V6*(-3.0*sin(θ5 - θ6) + 1.0*cos(θ5 - θ6)), -V5*(1.0*sin(θ4 - θ5) - 2.0*cos(θ4 - θ5)), -V1*(-0.829875518672199*sin(θ5) - 3.11203319502075*cos(θ5)) - V2*(1.0*sin(θ2 - θ5) - 3.0*cos(θ2 - θ5)) - V3*(1.46341463414634*sin(θ3 - θ5) - 3.17073170731707*cos(θ3 - θ5)) - V4*(1.0*sin(θ4 - θ5) - 2.0*cos(θ4 - θ5)) - 28.2755298046756*V5 - V6*(-1.0*sin(θ5 - θ6) - 3.0*cos(θ5 - θ6)), -V5*(-1.0*sin(θ5 - θ6) - 3.0*cos(θ5 - θ6))], [-V2*V6*(4.4543429844098*sin(θ2 - θ6) + 1.55902004454343*cos(θ2 - θ6)), -V3*V6*(9.61538461538461*sin(θ3 - θ6) + 1.92307692307692*cos(θ3 - θ6)), 0, -V5*V6*(3.0*sin(θ5 - θ6) + 1.0*cos(θ5 - θ6)), -V2*V6*(-4.4543429844098*sin(θ2 - θ6) - 1.55902004454343*cos(θ2 - θ6)) - V3*V6*(-9.61538461538461*sin(θ3 - θ6) - 1.92307692307692*cos(θ3 - θ6)) - V5*V6*(-3.0*sin(θ5 - θ6) - 1.0*cos(θ5 - θ6)), 0, -V6*(1.0*sin(θ5 - θ6) - 3.0*cos(θ5 - θ6)), -V2*(1.55902004454343*sin(θ2 - θ6) - 4.4543429844098*cos(θ2 - θ6)) - V3*(1.92307692307692*sin(θ3 - θ6) - 9.61538461538461*cos(θ3 - θ6)) - V5*(1.0*sin(θ5 - θ6) - 3.0*cos(θ5 - θ6)) - 34.0094551995888*V6]])
    elif tipo == 1:
        V2 = posicao[1]
        V3 = posicao[2]
        θ2 = x[0]
        θ3 = x[1]
        θ4 = x[2]
        θ5 = x[3]
        θ6 = x[4]
        V1 = x[5]
        V4 = x[6]
        V5 = x[7]
        V6 = x[8]
        ΔP2 = Pg2*(alpha + 1) - V1*V2*(4.0*sin(θ2) - 2.0*cos(θ2)) - 9.3282508137742*V2**2 - V2*V3*(3.84615384615385*sin(θ2 - θ3) - 0.769230769230769*cos(θ2 - θ3)) - V2*V4*(8.0*sin(θ2 - θ4) - 4.0*cos(θ2 - θ4)) - V2*V5*(3.0*sin(θ2 - θ5) - 1.0*cos(θ2 - θ5)) - V2*V6*(4.4543429844098*sin(θ2 - θ6) - 1.55902004454343*cos(θ2 - θ6))
        ΔP3 = Pg3*(alpha + 1) - V2*V3*(-3.84615384615385*sin(θ2 - θ3) - 0.769230769230769*cos(θ2 - θ3)) - 4.15572232645403*V3**2 - V3*V5*(3.17073170731707*sin(θ3 - θ5) - 1.46341463414634*cos(θ3 - θ5)) - V3*V6*(9.61538461538461*sin(θ3 - θ6) - 1.92307692307692*cos(θ3 - θ6))
        ΔP4 = -V1*V4*(4.70588235294118*sin(θ4) - 1.17647058823529*cos(θ4)) - V2*V4*(-8.0*sin(θ2 - θ4) - 4.0*cos(θ2 - θ4)) - 6.17647058823529*V4**2 - V4*V5*(2.0*sin(θ4 - θ5) - 1.0*cos(θ4 - θ5)) - 0.9*alpha - 0.9
        ΔP5 = -V1*V5*(3.11203319502075*sin(θ5) - 0.829875518672199*cos(θ5)) - V2*V5*(-3.0*sin(θ2 - θ5) - 1.0*cos(θ2 - θ5)) - V3*V5*(-3.17073170731707*sin(θ3 - θ5) - 1.46341463414634*cos(θ3 - θ5)) - V4*V5*(-2.0*sin(θ4 - θ5) - 1.0*cos(θ4 - θ5)) - 5.29329015281854*V5**2 - V5*V6*(3.0*sin(θ5 - θ6) - 1.0*cos(θ5 - θ6)) - alpha - 1
        ΔP6 = -V2*V6*(-4.4543429844098*sin(θ2 - θ6) - 1.55902004454343*cos(θ2 - θ6)) - V3*V6*(-9.61538461538461*sin(θ3 - θ6) - 1.92307692307692*cos(θ3 - θ6)) - V5*V6*(-3.0*sin(θ5 - θ6) - 1.0*cos(θ5 - θ6)) - 4.48209696762035*V6**2 - 0.9*alpha - 0.9
        ΔQ1 = Qg1 - 11.7479155479619*V1**2 - V1*V2*(2.0*sin(θ2) - 4.0*cos(θ2)) - V1*V4*(1.17647058823529*sin(θ4) - 4.70588235294118*cos(θ4)) - V1*V5*(0.829875518672199*sin(θ5) - 3.11203319502075*cos(θ5))
        ΔQ4 = -V1*V4*(-1.17647058823529*sin(θ4) - 4.70588235294118*cos(θ4)) - V2*V4*(4.0*sin(θ2 - θ4) - 8.0*cos(θ2 - θ4)) - 14.6358823529412*V4**2 - V4*V5*(-1.0*sin(θ4 - θ5) - 2.0*cos(θ4 - θ5)) - 0.6*alpha - 0.6
        ΔQ5 = -V1*V5*(-0.829875518672199*sin(θ5) - 3.11203319502075*cos(θ5)) - V2*V5*(1.0*sin(θ2 - θ5) - 3.0*cos(θ2 - θ5)) - V3*V5*(1.46341463414634*sin(θ3 - θ5) - 3.17073170731707*cos(θ3 - θ5)) - V4*V5*(1.0*sin(θ4 - θ5) - 2.0*cos(θ4 - θ5)) - 14.1377649023378*V5**2 - V5*V6*(-1.0*sin(θ5 - θ6) - 3.0*cos(θ5 - θ6)) - 0.7*alpha - 0.7
        ΔQ6 = -V2*V6*(1.55902004454343*sin(θ2 - θ6) - 4.4543429844098*cos(θ2 - θ6)) - V3*V6*(1.92307692307692*sin(θ3 - θ6) - 9.61538461538461*cos(θ3 - θ6)) - V5*V6*(1.0*sin(θ5 - θ6) - 3.0*cos(θ5 - θ6)) - 17.0047275997944*V6**2 - 0.6*alpha - 0.6
        B = np.array([ΔP2, ΔP3, ΔP4, ΔP5, ΔP6, ΔQ1, ΔQ4, ΔQ5, ΔQ6])
        A = np.array([[-V1*V2*(2.0*sin(θ2) + 4.0*cos(θ2)) - V2*V3*(0.769230769230769*sin(θ2 - θ3) + 3.84615384615385*cos(θ2 - θ3)) - V2*V4*(4.0*sin(θ2 - θ4) + 8.0*cos(θ2 - θ4)) - V2*V5*(1.0*sin(θ2 - θ5) + 3.0*cos(θ2 - θ5)) - V2*V6*(1.55902004454343*sin(θ2 - θ6) + 4.4543429844098*cos(θ2 - θ6)), -V2*V3*(-0.769230769230769*sin(θ2 - θ3) - 3.84615384615385*cos(θ2 - θ3)), -V2*V4*(-4.0*sin(θ2 - θ4) - 8.0*cos(θ2 - θ4)), -V2*V5*(-1.0*sin(θ2 - θ5) - 3.0*cos(θ2 - θ5)), -V2*V6*(-1.55902004454343*sin(θ2 - θ6) - 4.4543429844098*cos(θ2 - θ6)), -V2*(4.0*sin(θ2) - 2.0*cos(θ2)), -V2*(8.0*sin(θ2 - θ4) - 4.0*cos(θ2 - θ4)), -V2*(3.0*sin(θ2 - θ5) - 1.0*cos(θ2 - θ5)), -V2*(4.4543429844098*sin(θ2 - θ6) - 1.55902004454343*cos(θ2 - θ6))], [-V2*V3*(0.769230769230769*sin(θ2 - θ3) - 3.84615384615385*cos(θ2 - θ3)), -V2*V3*(-0.769230769230769*sin(θ2 - θ3) + 3.84615384615385*cos(θ2 - θ3)) - V3*V5*(1.46341463414634*sin(θ3 - θ5) + 3.17073170731707*cos(θ3 - θ5)) - V3*V6*(1.92307692307692*sin(θ3 - θ6) + 9.61538461538461*cos(θ3 - θ6)), 0, -V3*V5*(-1.46341463414634*sin(θ3 - θ5) - 3.17073170731707*cos(θ3 - θ5)), -V3*V6*(-1.92307692307692*sin(θ3 - θ6) - 9.61538461538461*cos(θ3 - θ6)), 0, 0, -V3*(3.17073170731707*sin(θ3 - θ5) - 1.46341463414634*cos(θ3 - θ5)), -V3*(9.61538461538461*sin(θ3 - θ6) - 1.92307692307692*cos(θ3 - θ6))], [-V2*V4*(4.0*sin(θ2 - θ4) - 8.0*cos(θ2 - θ4)), 0, -V1*V4*(1.17647058823529*sin(θ4) + 4.70588235294118*cos(θ4)) - V2*V4*(-4.0*sin(θ2 - θ4) + 8.0*cos(θ2 - θ4)) - V4*V5*(1.0*sin(θ4 - θ5) + 2.0*cos(θ4 - θ5)), -V4*V5*(-1.0*sin(θ4 - θ5) - 2.0*cos(θ4 - θ5)), 0, -V4*(4.70588235294118*sin(θ4) - 1.17647058823529*cos(θ4)), -V1*(4.70588235294118*sin(θ4) - 1.17647058823529*cos(θ4)) - V2*(-8.0*sin(θ2 - θ4) - 4.0*cos(θ2 - θ4)) - 12.3529411764706*V4 - V5*(2.0*sin(θ4 - θ5) - 1.0*cos(θ4 - θ5)), -V4*(2.0*sin(θ4 - θ5) - 1.0*cos(θ4 - θ5)), 0], [-V2*V5*(1.0*sin(θ2 - θ5) - 3.0*cos(θ2 - θ5)), -V3*V5*(1.46341463414634*sin(θ3 - θ5) - 3.17073170731707*cos(θ3 - θ5)), -V4*V5*(1.0*sin(θ4 - θ5) - 2.0*cos(θ4 - θ5)), -V1*V5*(0.829875518672199*sin(θ5) + 3.11203319502075*cos(θ5)) - V2*V5*(-1.0*sin(θ2 - θ5) + 3.0*cos(θ2 - θ5)) - V3*V5*(-1.46341463414634*sin(θ3 - θ5) + 3.17073170731707*cos(θ3 - θ5)) - V4*V5*(-1.0*sin(θ4 - θ5) + 2.0*cos(θ4 - θ5)) - V5*V6*(1.0*sin(θ5 - θ6) + 3.0*cos(θ5 - θ6)), -V5*V6*(-1.0*sin(θ5 - θ6) - 3.0*cos(θ5 - θ6)), -V5*(3.11203319502075*sin(θ5) - 0.829875518672199*cos(θ5)), -V5*(-2.0*sin(θ4 - θ5) - 1.0*cos(θ4 - θ5)), -V1*(3.11203319502075*sin(θ5) - 0.829875518672199*cos(θ5)) - V2*(-3.0*sin(θ2 - θ5) - 1.0*cos(θ2 - θ5)) - V3*(-3.17073170731707*sin(θ3 - θ5) - 1.46341463414634*cos(θ3 - θ5)) - V4*(-2.0*sin(θ4 - θ5) - 1.0*cos(θ4 - θ5)) - 10.5865803056371*V5 - V6*(3.0*sin(θ5 - θ6) - 1.0*cos(θ5 - θ6)), -V5*(3.0*sin(θ5 - θ6) - 1.0*cos(θ5 - θ6))], [-V2*V6*(1.55902004454343*sin(θ2 - θ6) - 4.4543429844098*cos(θ2 - θ6)), -V3*V6*(1.92307692307692*sin(θ3 - θ6) - 9.61538461538461*cos(θ3 - θ6)), 0, -V5*V6*(1.0*sin(θ5 - θ6) - 3.0*cos(θ5 - θ6)), -V2*V6*(-1.55902004454343*sin(θ2 - θ6) + 4.4543429844098*cos(θ2 - θ6)) - V3*V6*(-1.92307692307692*sin(θ3 - θ6) + 9.61538461538461*cos(θ3 - θ6)) - V5*V6*(-1.0*sin(θ5 - θ6) + 3.0*cos(θ5 - θ6)), 0, 0, -V6*(-3.0*sin(θ5 - θ6) - 1.0*cos(θ5 - θ6)), -V2*(-4.4543429844098*sin(θ2 - θ6) - 1.55902004454343*cos(θ2 - θ6)) - V3*(-9.61538461538461*sin(θ3 - θ6) - 1.92307692307692*cos(θ3 - θ6)) - V5*(-3.0*sin(θ5 - θ6) - 1.0*cos(θ5 - θ6)) - 8.96419393524071*V6], [-V1*V2*(4.0*sin(θ2) + 2.0*cos(θ2)), 0, -V1*V4*(4.70588235294118*sin(θ4) + 1.17647058823529*cos(θ4)), -V1*V5*(3.11203319502075*sin(θ5) + 0.829875518672199*cos(θ5)), 0, -23.4958310959238*V1 - V2*(2.0*sin(θ2) - 4.0*cos(θ2)) - V4*(1.17647058823529*sin(θ4) - 4.70588235294118*cos(θ4)) - V5*(0.829875518672199*sin(θ5) - 3.11203319502075*cos(θ5)), -V1*(1.17647058823529*sin(θ4) - 4.70588235294118*cos(θ4)), -V1*(0.829875518672199*sin(θ5) - 3.11203319502075*cos(θ5)), 0], [-V2*V4*(8.0*sin(θ2 - θ4) + 4.0*cos(θ2 - θ4)), 0, -V1*V4*(4.70588235294118*sin(θ4) - 1.17647058823529*cos(θ4)) - V2*V4*(-8.0*sin(θ2 - θ4) - 4.0*cos(θ2 - θ4)) - V4*V5*(2.0*sin(θ4 - θ5) - 1.0*cos(θ4 - θ5)), -V4*V5*(-2.0*sin(θ4 - θ5) + 1.0*cos(θ4 - θ5)), 0, -V4*(-1.17647058823529*sin(θ4) - 4.70588235294118*cos(θ4)), -V1*(-1.17647058823529*sin(θ4) - 4.70588235294118*cos(θ4)) - V2*(4.0*sin(θ2 - θ4) - 8.0*cos(θ2 - θ4)) - 29.2717647058824*V4 - V5*(-1.0*sin(θ4 - θ5) - 2.0*cos(θ4 - θ5)), -V4*(-1.0*sin(θ4 - θ5) - 2.0*cos(θ4 - θ5)), 0], [-V2*V5*(3.0*sin(θ2 - θ5) + 1.0*cos(θ2 - θ5)), -V3*V5*(3.17073170731707*sin(θ3 - θ5) + 1.46341463414634*cos(θ3 - θ5)), -V4*V5*(2.0*sin(θ4 - θ5) + 1.0*cos(θ4 - θ5)), -V1*V5*(3.11203319502075*sin(θ5) - 0.829875518672199*cos(θ5)) - V2*V5*(-3.0*sin(θ2 - θ5) - 1.0*cos(θ2 - θ5)) - V3*V5*(-3.17073170731707*sin(θ3 - θ5) - 1.46341463414634*cos(θ3 - θ5)) - V4*V5*(-2.0*sin(θ4 - θ5) - 1.0*cos(θ4 - θ5)) - V5*V6*(3.0*sin(θ5 - θ6) - 1.0*cos(θ5 - θ6)), -V5*V6*(-3.0*sin(θ5 - θ6) + 1.0*cos(θ5 - θ6)), -V5*(-0.829875518672199*sin(θ5) - 3.11203319502075*cos(θ5)), -V5*(1.0*sin(θ4 - θ5) - 2.0*cos(θ4 - θ5)), -V1*(-0.829875518672199*sin(θ5) - 3.11203319502075*cos(θ5)) - V2*(1.0*sin(θ2 - θ5) - 3.0*cos(θ2 - θ5)) - V3*(1.46341463414634*sin(θ3 - θ5) - 3.17073170731707*cos(θ3 - θ5)) - V4*(1.0*sin(θ4 - θ5) - 2.0*cos(θ4 - θ5)) - 28.2755298046756*V5 - V6*(-1.0*sin(θ5 - θ6) - 3.0*cos(θ5 - θ6)), -V5*(-1.0*sin(θ5 - θ6) - 3.0*cos(θ5 - θ6))], [-V2*V6*(4.4543429844098*sin(θ2 - θ6) + 1.55902004454343*cos(θ2 - θ6)), -V3*V6*(9.61538461538461*sin(θ3 - θ6) + 1.92307692307692*cos(θ3 - θ6)), 0, -V5*V6*(3.0*sin(θ5 - θ6) + 1.0*cos(θ5 - θ6)), -V2*V6*(-4.4543429844098*sin(θ2 - θ6) - 1.55902004454343*cos(θ2 - θ6)) - V3*V6*(-9.61538461538461*sin(θ3 - θ6) - 1.92307692307692*cos(θ3 - θ6)) - V5*V6*(-3.0*sin(θ5 - θ6) - 1.0*cos(θ5 - θ6)), 0, 0, -V6*(1.0*sin(θ5 - θ6) - 3.0*cos(θ5 - θ6)), -V2*(1.55902004454343*sin(θ2 - θ6) - 4.4543429844098*cos(θ2 - θ6)) - V3*(1.92307692307692*sin(θ3 - θ6) - 9.61538461538461*cos(θ3 - θ6)) - V5*(1.0*sin(θ5 - θ6) - 3.0*cos(θ5 - θ6)) - 34.0094551995888*V6]])
    elif tipo == 2:
        V1 = posicao[0]
        V3 = posicao[2]
        θ2 = x[0]
        θ3 = x[1]
        θ4 = x[2]
        θ5 = x[3]
        θ6 = x[4]
        V2 = x[5]
        V4 = x[6]
        V5 = x[7]
        V6 = x[8]
        ΔP2 = Pg2*(alpha + 1) - V1*V2*(4.0*sin(θ2) - 2.0*cos(θ2)) - 9.3282508137742*V2**2 - V2*V3*(3.84615384615385*sin(θ2 - θ3) - 0.769230769230769*cos(θ2 - θ3)) - V2*V4*(8.0*sin(θ2 - θ4) - 4.0*cos(θ2 - θ4)) - V2*V5*(3.0*sin(θ2 - θ5) - 1.0*cos(θ2 - θ5)) - V2*V6*(4.4543429844098*sin(θ2 - θ6) - 1.55902004454343*cos(θ2 - θ6))
        ΔP3 = Pg3*(alpha + 1) - V2*V3*(-3.84615384615385*sin(θ2 - θ3) - 0.769230769230769*cos(θ2 - θ3)) - 4.15572232645403*V3**2 - V3*V5*(3.17073170731707*sin(θ3 - θ5) - 1.46341463414634*cos(θ3 - θ5)) - V3*V6*(9.61538461538461*sin(θ3 - θ6) - 1.92307692307692*cos(θ3 - θ6))
        ΔP4 = -V1*V4*(4.70588235294118*sin(θ4) - 1.17647058823529*cos(θ4)) - V2*V4*(-8.0*sin(θ2 - θ4) - 4.0*cos(θ2 - θ4)) - 6.17647058823529*V4**2 - V4*V5*(2.0*sin(θ4 - θ5) - 1.0*cos(θ4 - θ5)) - 0.9*alpha - 0.9
        ΔP5 = -V1*V5*(3.11203319502075*sin(θ5) - 0.829875518672199*cos(θ5)) - V2*V5*(-3.0*sin(θ2 - θ5) - 1.0*cos(θ2 - θ5)) - V3*V5*(-3.17073170731707*sin(θ3 - θ5) - 1.46341463414634*cos(θ3 - θ5)) - V4*V5*(-2.0*sin(θ4 - θ5) - 1.0*cos(θ4 - θ5)) - 5.29329015281854*V5**2 - V5*V6*(3.0*sin(θ5 - θ6) - 1.0*cos(θ5 - θ6)) - alpha - 1
        ΔP6 = -V2*V6*(-4.4543429844098*sin(θ2 - θ6) - 1.55902004454343*cos(θ2 - θ6)) - V3*V6*(-9.61538461538461*sin(θ3 - θ6) - 1.92307692307692*cos(θ3 - θ6)) - V5*V6*(-3.0*sin(θ5 - θ6) - 1.0*cos(θ5 - θ6)) - 4.48209696762035*V6**2 - 0.9*alpha - 0.9
        ΔQ2 = Qg2 - V1*V2*(-2.0*sin(θ2) - 4.0*cos(θ2)) - 23.1954968305636*V2**2 - V2*V3*(-0.769230769230769*sin(θ2 - θ3) - 3.84615384615385*cos(θ2 - θ3)) - V2*V4*(-4.0*sin(θ2 - θ4) - 8.0*cos(θ2 - θ4)) - V2*V5*(-1.0*sin(θ2 - θ5) - 3.0*cos(θ2 - θ5)) - V2*V6*(-1.55902004454343*sin(θ2 - θ6) - 4.4543429844098*cos(θ2 - θ6))
        ΔQ4 = -V1*V4*(-1.17647058823529*sin(θ4) - 4.70588235294118*cos(θ4)) - V2*V4*(4.0*sin(θ2 - θ4) - 8.0*cos(θ2 - θ4)) - 14.6358823529412*V4**2 - V4*V5*(-1.0*sin(θ4 - θ5) - 2.0*cos(θ4 - θ5)) - 0.6*alpha - 0.6
        ΔQ5 = -V1*V5*(-0.829875518672199*sin(θ5) - 3.11203319502075*cos(θ5)) - V2*V5*(1.0*sin(θ2 - θ5) - 3.0*cos(θ2 - θ5)) - V3*V5*(1.46341463414634*sin(θ3 - θ5) - 3.17073170731707*cos(θ3 - θ5)) - V4*V5*(1.0*sin(θ4 - θ5) - 2.0*cos(θ4 - θ5)) - 14.1377649023378*V5**2 - V5*V6*(-1.0*sin(θ5 - θ6) - 3.0*cos(θ5 - θ6)) - 0.7*alpha - 0.7
        ΔQ6 = -V2*V6*(1.55902004454343*sin(θ2 - θ6) - 4.4543429844098*cos(θ2 - θ6)) - V3*V6*(1.92307692307692*sin(θ3 - θ6) - 9.61538461538461*cos(θ3 - θ6)) - V5*V6*(1.0*sin(θ5 - θ6) - 3.0*cos(θ5 - θ6)) - 17.0047275997944*V6**2 - 0.6*alpha - 0.6
        B = np.array([ΔP2, ΔP3, ΔP4, ΔP5, ΔP6, ΔQ2, ΔQ4, ΔQ5, ΔQ6])
        A = np.array([[-V1*V2*(2.0*sin(θ2) + 4.0*cos(θ2)) - V2*V3*(0.769230769230769*sin(θ2 - θ3) + 3.84615384615385*cos(θ2 - θ3)) - V2*V4*(4.0*sin(θ2 - θ4) + 8.0*cos(θ2 - θ4)) - V2*V5*(1.0*sin(θ2 - θ5) + 3.0*cos(θ2 - θ5)) - V2*V6*(1.55902004454343*sin(θ2 - θ6) + 4.4543429844098*cos(θ2 - θ6)), -V2*V3*(-0.769230769230769*sin(θ2 - θ3) - 3.84615384615385*cos(θ2 - θ3)), -V2*V4*(-4.0*sin(θ2 - θ4) - 8.0*cos(θ2 - θ4)), -V2*V5*(-1.0*sin(θ2 - θ5) - 3.0*cos(θ2 - θ5)), -V2*V6*(-1.55902004454343*sin(θ2 - θ6) - 4.4543429844098*cos(θ2 - θ6)), -V1*(4.0*sin(θ2) - 2.0*cos(θ2)) - 18.6565016275484*V2 - V3*(3.84615384615385*sin(θ2 - θ3) - 0.769230769230769*cos(θ2 - θ3)) - V4*(8.0*sin(θ2 - θ4) - 4.0*cos(θ2 - θ4)) - V5*(3.0*sin(θ2 - θ5) - 1.0*cos(θ2 - θ5)) - V6*(4.4543429844098*sin(θ2 - θ6) - 1.55902004454343*cos(θ2 - θ6)), -V2*(8.0*sin(θ2 - θ4) - 4.0*cos(θ2 - θ4)), -V2*(3.0*sin(θ2 - θ5) - 1.0*cos(θ2 - θ5)), -V2*(4.4543429844098*sin(θ2 - θ6) - 1.55902004454343*cos(θ2 - θ6))], [-V2*V3*(0.769230769230769*sin(θ2 - θ3) - 3.84615384615385*cos(θ2 - θ3)), -V2*V3*(-0.769230769230769*sin(θ2 - θ3) + 3.84615384615385*cos(θ2 - θ3)) - V3*V5*(1.46341463414634*sin(θ3 - θ5) + 3.17073170731707*cos(θ3 - θ5)) - V3*V6*(1.92307692307692*sin(θ3 - θ6) + 9.61538461538461*cos(θ3 - θ6)), 0, -V3*V5*(-1.46341463414634*sin(θ3 - θ5) - 3.17073170731707*cos(θ3 - θ5)), -V3*V6*(-1.92307692307692*sin(θ3 - θ6) - 9.61538461538461*cos(θ3 - θ6)), -V3*(-3.84615384615385*sin(θ2 - θ3) - 0.769230769230769*cos(θ2 - θ3)), 0, -V3*(3.17073170731707*sin(θ3 - θ5) - 1.46341463414634*cos(θ3 - θ5)), -V3*(9.61538461538461*sin(θ3 - θ6) - 1.92307692307692*cos(θ3 - θ6))], [-V2*V4*(4.0*sin(θ2 - θ4) - 8.0*cos(θ2 - θ4)), 0, -V1*V4*(1.17647058823529*sin(θ4) + 4.70588235294118*cos(θ4)) - V2*V4*(-4.0*sin(θ2 - θ4) + 8.0*cos(θ2 - θ4)) - V4*V5*(1.0*sin(θ4 - θ5) + 2.0*cos(θ4 - θ5)), -V4*V5*(-1.0*sin(θ4 - θ5) - 2.0*cos(θ4 - θ5)), 0, -V4*(-8.0*sin(θ2 - θ4) - 4.0*cos(θ2 - θ4)), -V1*(4.70588235294118*sin(θ4) - 1.17647058823529*cos(θ4)) - V2*(-8.0*sin(θ2 - θ4) - 4.0*cos(θ2 - θ4)) - 12.3529411764706*V4 - V5*(2.0*sin(θ4 - θ5) - 1.0*cos(θ4 - θ5)), -V4*(2.0*sin(θ4 - θ5) - 1.0*cos(θ4 - θ5)), 0], [-V2*V5*(1.0*sin(θ2 - θ5) - 3.0*cos(θ2 - θ5)), -V3*V5*(1.46341463414634*sin(θ3 - θ5) - 3.17073170731707*cos(θ3 - θ5)), -V4*V5*(1.0*sin(θ4 - θ5) - 2.0*cos(θ4 - θ5)), -V1*V5*(0.829875518672199*sin(θ5) + 3.11203319502075*cos(θ5)) - V2*V5*(-1.0*sin(θ2 - θ5) + 3.0*cos(θ2 - θ5)) - V3*V5*(-1.46341463414634*sin(θ3 - θ5) + 3.17073170731707*cos(θ3 - θ5)) - V4*V5*(-1.0*sin(θ4 - θ5) + 2.0*cos(θ4 - θ5)) - V5*V6*(1.0*sin(θ5 - θ6) + 3.0*cos(θ5 - θ6)), -V5*V6*(-1.0*sin(θ5 - θ6) - 3.0*cos(θ5 - θ6)), -V5*(-3.0*sin(θ2 - θ5) - 1.0*cos(θ2 - θ5)), -V5*(-2.0*sin(θ4 - θ5) - 1.0*cos(θ4 - θ5)), -V1*(3.11203319502075*sin(θ5) - 0.829875518672199*cos(θ5)) - V2*(-3.0*sin(θ2 - θ5) - 1.0*cos(θ2 - θ5)) - V3*(-3.17073170731707*sin(θ3 - θ5) - 1.46341463414634*cos(θ3 - θ5)) - V4*(-2.0*sin(θ4 - θ5) - 1.0*cos(θ4 - θ5)) - 10.5865803056371*V5 - V6*(3.0*sin(θ5 - θ6) - 1.0*cos(θ5 - θ6)), -V5*(3.0*sin(θ5 - θ6) - 1.0*cos(θ5 - θ6))], [-V2*V6*(1.55902004454343*sin(θ2 - θ6) - 4.4543429844098*cos(θ2 - θ6)), -V3*V6*(1.92307692307692*sin(θ3 - θ6) - 9.61538461538461*cos(θ3 - θ6)), 0, -V5*V6*(1.0*sin(θ5 - θ6) - 3.0*cos(θ5 - θ6)), -V2*V6*(-1.55902004454343*sin(θ2 - θ6) + 4.4543429844098*cos(θ2 - θ6)) - V3*V6*(-1.92307692307692*sin(θ3 - θ6) + 9.61538461538461*cos(θ3 - θ6)) - V5*V6*(-1.0*sin(θ5 - θ6) + 3.0*cos(θ5 - θ6)), -V6*(-4.4543429844098*sin(θ2 - θ6) - 1.55902004454343*cos(θ2 - θ6)), 0, -V6*(-3.0*sin(θ5 - θ6) - 1.0*cos(θ5 - θ6)), -V2*(-4.4543429844098*sin(θ2 - θ6) - 1.55902004454343*cos(θ2 - θ6)) - V3*(-9.61538461538461*sin(θ3 - θ6) - 1.92307692307692*cos(θ3 - θ6)) - V5*(-3.0*sin(θ5 - θ6) - 1.0*cos(θ5 - θ6)) - 8.96419393524071*V6], [-V1*V2*(4.0*sin(θ2) - 2.0*cos(θ2)) - V2*V3*(3.84615384615385*sin(θ2 - θ3) - 0.769230769230769*cos(θ2 - θ3)) - V2*V4*(8.0*sin(θ2 - θ4) - 4.0*cos(θ2 - θ4)) - V2*V5*(3.0*sin(θ2 - θ5) - 1.0*cos(θ2 - θ5)) - V2*V6*(4.4543429844098*sin(θ2 - θ6) - 1.55902004454343*cos(θ2 - θ6)), -V2*V3*(-3.84615384615385*sin(θ2 - θ3) + 0.769230769230769*cos(θ2 - θ3)), -V2*V4*(-8.0*sin(θ2 - θ4) + 4.0*cos(θ2 - θ4)), -V2*V5*(-3.0*sin(θ2 - θ5) + 1.0*cos(θ2 - θ5)), -V2*V6*(-4.4543429844098*sin(θ2 - θ6) + 1.55902004454343*cos(θ2 - θ6)), -V1*(-2.0*sin(θ2) - 4.0*cos(θ2)) - 46.3909936611273*V2 - V3*(-0.769230769230769*sin(θ2 - θ3) - 3.84615384615385*cos(θ2 - θ3)) - V4*(-4.0*sin(θ2 - θ4) - 8.0*cos(θ2 - θ4)) - V5*(-1.0*sin(θ2 - θ5) - 3.0*cos(θ2 - θ5)) - V6*(-1.55902004454343*sin(θ2 - θ6) - 4.4543429844098*cos(θ2 - θ6)), -V2*(-4.0*sin(θ2 - θ4) - 8.0*cos(θ2 - θ4)), -V2*(-1.0*sin(θ2 - θ5) - 3.0*cos(θ2 - θ5)), -V2*(-1.55902004454343*sin(θ2 - θ6) - 4.4543429844098*cos(θ2 - θ6))], [-V2*V4*(8.0*sin(θ2 - θ4) + 4.0*cos(θ2 - θ4)), 0, -V1*V4*(4.70588235294118*sin(θ4) - 1.17647058823529*cos(θ4)) - V2*V4*(-8.0*sin(θ2 - θ4) - 4.0*cos(θ2 - θ4)) - V4*V5*(2.0*sin(θ4 - θ5) - 1.0*cos(θ4 - θ5)), -V4*V5*(-2.0*sin(θ4 - θ5) + 1.0*cos(θ4 - θ5)), 0, -V4*(4.0*sin(θ2 - θ4) - 8.0*cos(θ2 - θ4)), -V1*(-1.17647058823529*sin(θ4) - 4.70588235294118*cos(θ4)) - V2*(4.0*sin(θ2 - θ4) - 8.0*cos(θ2 - θ4)) - 29.2717647058824*V4 - V5*(-1.0*sin(θ4 - θ5) - 2.0*cos(θ4 - θ5)), -V4*(-1.0*sin(θ4 - θ5) - 2.0*cos(θ4 - θ5)), 0], [-V2*V5*(3.0*sin(θ2 - θ5) + 1.0*cos(θ2 - θ5)), -V3*V5*(3.17073170731707*sin(θ3 - θ5) + 1.46341463414634*cos(θ3 - θ5)), -V4*V5*(2.0*sin(θ4 - θ5) + 1.0*cos(θ4 - θ5)), -V1*V5*(3.11203319502075*sin(θ5) - 0.829875518672199*cos(θ5)) - V2*V5*(-3.0*sin(θ2 - θ5) - 1.0*cos(θ2 - θ5)) - V3*V5*(-3.17073170731707*sin(θ3 - θ5) - 1.46341463414634*cos(θ3 - θ5)) - V4*V5*(-2.0*sin(θ4 - θ5) - 1.0*cos(θ4 - θ5)) - V5*V6*(3.0*sin(θ5 - θ6) - 1.0*cos(θ5 - θ6)), -V5*V6*(-3.0*sin(θ5 - θ6) + 1.0*cos(θ5 - θ6)), -V5*(1.0*sin(θ2 - θ5) - 3.0*cos(θ2 - θ5)), -V5*(1.0*sin(θ4 - θ5) - 2.0*cos(θ4 - θ5)), -V1*(-0.829875518672199*sin(θ5) - 3.11203319502075*cos(θ5)) - V2*(1.0*sin(θ2 - θ5) - 3.0*cos(θ2 - θ5)) - V3*(1.46341463414634*sin(θ3 - θ5) - 3.17073170731707*cos(θ3 - θ5)) - V4*(1.0*sin(θ4 - θ5) - 2.0*cos(θ4 - θ5)) - 28.2755298046756*V5 - V6*(-1.0*sin(θ5 - θ6) - 3.0*cos(θ5 - θ6)), -V5*(-1.0*sin(θ5 - θ6) - 3.0*cos(θ5 - θ6))], [-V2*V6*(4.4543429844098*sin(θ2 - θ6) + 1.55902004454343*cos(θ2 - θ6)), -V3*V6*(9.61538461538461*sin(θ3 - θ6) + 1.92307692307692*cos(θ3 - θ6)), 0, -V5*V6*(3.0*sin(θ5 - θ6) + 1.0*cos(θ5 - θ6)), -V2*V6*(-4.4543429844098*sin(θ2 - θ6) - 1.55902004454343*cos(θ2 - θ6)) - V3*V6*(-9.61538461538461*sin(θ3 - θ6) - 1.92307692307692*cos(θ3 - θ6)) - V5*V6*(-3.0*sin(θ5 - θ6) - 1.0*cos(θ5 - θ6)), -V6*(1.55902004454343*sin(θ2 - θ6) - 4.4543429844098*cos(θ2 - θ6)), 0, -V6*(1.0*sin(θ5 - θ6) - 3.0*cos(θ5 - θ6)), -V2*(1.55902004454343*sin(θ2 - θ6) - 4.4543429844098*cos(θ2 - θ6)) - V3*(1.92307692307692*sin(θ3 - θ6) - 9.61538461538461*cos(θ3 - θ6)) - V5*(1.0*sin(θ5 - θ6) - 3.0*cos(θ5 - θ6)) - 34.0094551995888*V6]])
    elif tipo == 3:
        V1 = posicao[0]
        V2 = posicao[1]
        θ2 = x[0]
        θ3 = x[1]
        θ4 = x[2]
        θ5 = x[3]
        θ6 = x[4]
        V3 = x[5]
        V4 = x[6]
        V5 = x[7]
        V6 = x[8]
        ΔP2 = Pg2*(alpha + 1) - V1*V2*(4.0*sin(θ2) - 2.0*cos(θ2)) - 9.3282508137742*V2**2 - V2*V3*(3.84615384615385*sin(θ2 - θ3) - 0.769230769230769*cos(θ2 - θ3)) - V2*V4*(8.0*sin(θ2 - θ4) - 4.0*cos(θ2 - θ4)) - V2*V5*(3.0*sin(θ2 - θ5) - 1.0*cos(θ2 - θ5)) - V2*V6*(4.4543429844098*sin(θ2 - θ6) - 1.55902004454343*cos(θ2 - θ6))
        ΔP3 = Pg3*(alpha + 1) - V2*V3*(-3.84615384615385*sin(θ2 - θ3) - 0.769230769230769*cos(θ2 - θ3)) - 4.15572232645403*V3**2 - V3*V5*(3.17073170731707*sin(θ3 - θ5) - 1.46341463414634*cos(θ3 - θ5)) - V3*V6*(9.61538461538461*sin(θ3 - θ6) - 1.92307692307692*cos(θ3 - θ6))
        ΔP4 = -V1*V4*(4.70588235294118*sin(θ4) - 1.17647058823529*cos(θ4)) - V2*V4*(-8.0*sin(θ2 - θ4) - 4.0*cos(θ2 - θ4)) - 6.17647058823529*V4**2 - V4*V5*(2.0*sin(θ4 - θ5) - 1.0*cos(θ4 - θ5)) - 0.9*alpha - 0.9
        ΔP5 = -V1*V5*(3.11203319502075*sin(θ5) - 0.829875518672199*cos(θ5)) - V2*V5*(-3.0*sin(θ2 - θ5) - 1.0*cos(θ2 - θ5)) - V3*V5*(-3.17073170731707*sin(θ3 - θ5) - 1.46341463414634*cos(θ3 - θ5)) - V4*V5*(-2.0*sin(θ4 - θ5) - 1.0*cos(θ4 - θ5)) - 5.29329015281854*V5**2 - V5*V6*(3.0*sin(θ5 - θ6) - 1.0*cos(θ5 - θ6)) - alpha - 1
        ΔP6 = -V2*V6*(-4.4543429844098*sin(θ2 - θ6) - 1.55902004454343*cos(θ2 - θ6)) - V3*V6*(-9.61538461538461*sin(θ3 - θ6) - 1.92307692307692*cos(θ3 - θ6)) - V5*V6*(-3.0*sin(θ5 - θ6) - 1.0*cos(θ5 - θ6)) - 4.48209696762035*V6**2 - 0.9*alpha - 0.9
        ΔQ3 = Qg3 - V2*V3*(0.769230769230769*sin(θ2 - θ3) - 3.84615384615385*cos(θ2 - θ3)) - 16.5672701688555*V3**2 - V3*V5*(-1.46341463414634*sin(θ3 - θ5) - 3.17073170731707*cos(θ3 - θ5)) - V3*V6*(-1.92307692307692*sin(θ3 - θ6) - 9.61538461538461*cos(θ3 - θ6))
        ΔQ4 = -V1*V4*(-1.17647058823529*sin(θ4) - 4.70588235294118*cos(θ4)) - V2*V4*(4.0*sin(θ2 - θ4) - 8.0*cos(θ2 - θ4)) - 14.6358823529412*V4**2 - V4*V5*(-1.0*sin(θ4 - θ5) - 2.0*cos(θ4 - θ5)) - 0.6*alpha - 0.6
        ΔQ5 = -V1*V5*(-0.829875518672199*sin(θ5) - 3.11203319502075*cos(θ5)) - V2*V5*(1.0*sin(θ2 - θ5) - 3.0*cos(θ2 - θ5)) - V3*V5*(1.46341463414634*sin(θ3 - θ5) - 3.17073170731707*cos(θ3 - θ5)) - V4*V5*(1.0*sin(θ4 - θ5) - 2.0*cos(θ4 - θ5)) - 14.1377649023378*V5**2 - V5*V6*(-1.0*sin(θ5 - θ6) - 3.0*cos(θ5 - θ6)) - 0.7*alpha - 0.7
        ΔQ6 = -V2*V6*(1.55902004454343*sin(θ2 - θ6) - 4.4543429844098*cos(θ2 - θ6)) - V3*V6*(1.92307692307692*sin(θ3 - θ6) - 9.61538461538461*cos(θ3 - θ6)) - V5*V6*(1.0*sin(θ5 - θ6) - 3.0*cos(θ5 - θ6)) - 17.0047275997944*V6**2 - 0.6*alpha - 0.6
        B = np.array([ΔP2, ΔP3, ΔP4, ΔP5, ΔP6, ΔQ3, ΔQ4, ΔQ5, ΔQ6])
        A = np.array([[-V1*V2*(2.0*sin(θ2) + 4.0*cos(θ2)) - V2*V3*(0.769230769230769*sin(θ2 - θ3) + 3.84615384615385*cos(θ2 - θ3)) - V2*V4*(4.0*sin(θ2 - θ4) + 8.0*cos(θ2 - θ4)) - V2*V5*(1.0*sin(θ2 - θ5) + 3.0*cos(θ2 - θ5)) - V2*V6*(1.55902004454343*sin(θ2 - θ6) + 4.4543429844098*cos(θ2 - θ6)), -V2*V3*(-0.769230769230769*sin(θ2 - θ3) - 3.84615384615385*cos(θ2 - θ3)), -V2*V4*(-4.0*sin(θ2 - θ4) - 8.0*cos(θ2 - θ4)), -V2*V5*(-1.0*sin(θ2 - θ5) - 3.0*cos(θ2 - θ5)), -V2*V6*(-1.55902004454343*sin(θ2 - θ6) - 4.4543429844098*cos(θ2 - θ6)), -V2*(3.84615384615385*sin(θ2 - θ3) - 0.769230769230769*cos(θ2 - θ3)), -V2*(8.0*sin(θ2 - θ4) - 4.0*cos(θ2 - θ4)), -V2*(3.0*sin(θ2 - θ5) - 1.0*cos(θ2 - θ5)), -V2*(4.4543429844098*sin(θ2 - θ6) - 1.55902004454343*cos(θ2 - θ6))], [-V2*V3*(0.769230769230769*sin(θ2 - θ3) - 3.84615384615385*cos(θ2 - θ3)), -V2*V3*(-0.769230769230769*sin(θ2 - θ3) + 3.84615384615385*cos(θ2 - θ3)) - V3*V5*(1.46341463414634*sin(θ3 - θ5) + 3.17073170731707*cos(θ3 - θ5)) - V3*V6*(1.92307692307692*sin(θ3 - θ6) + 9.61538461538461*cos(θ3 - θ6)), 0, -V3*V5*(-1.46341463414634*sin(θ3 - θ5) - 3.17073170731707*cos(θ3 - θ5)), -V3*V6*(-1.92307692307692*sin(θ3 - θ6) - 9.61538461538461*cos(θ3 - θ6)), -V2*(-3.84615384615385*sin(θ2 - θ3) - 0.769230769230769*cos(θ2 - θ3)) - 8.31144465290807*V3 - V5*(3.17073170731707*sin(θ3 - θ5) - 1.46341463414634*cos(θ3 - θ5)) - V6*(9.61538461538461*sin(θ3 - θ6) - 1.92307692307692*cos(θ3 - θ6)), 0, -V3*(3.17073170731707*sin(θ3 - θ5) - 1.46341463414634*cos(θ3 - θ5)), -V3*(9.61538461538461*sin(θ3 - θ6) - 1.92307692307692*cos(θ3 - θ6))], [-V2*V4*(4.0*sin(θ2 - θ4) - 8.0*cos(θ2 - θ4)), 0, -V1*V4*(1.17647058823529*sin(θ4) + 4.70588235294118*cos(θ4)) - V2*V4*(-4.0*sin(θ2 - θ4) + 8.0*cos(θ2 - θ4)) - V4*V5*(1.0*sin(θ4 - θ5) + 2.0*cos(θ4 - θ5)), -V4*V5*(-1.0*sin(θ4 - θ5) - 2.0*cos(θ4 - θ5)), 0, 0, -V1*(4.70588235294118*sin(θ4) - 1.17647058823529*cos(θ4)) - V2*(-8.0*sin(θ2 - θ4) - 4.0*cos(θ2 - θ4)) - 12.3529411764706*V4 - V5*(2.0*sin(θ4 - θ5) - 1.0*cos(θ4 - θ5)), -V4*(2.0*sin(θ4 - θ5) - 1.0*cos(θ4 - θ5)), 0], [-V2*V5*(1.0*sin(θ2 - θ5) - 3.0*cos(θ2 - θ5)), -V3*V5*(1.46341463414634*sin(θ3 - θ5) - 3.17073170731707*cos(θ3 - θ5)), -V4*V5*(1.0*sin(θ4 - θ5) - 2.0*cos(θ4 - θ5)), -V1*V5*(0.829875518672199*sin(θ5) + 3.11203319502075*cos(θ5)) - V2*V5*(-1.0*sin(θ2 - θ5) + 3.0*cos(θ2 - θ5)) - V3*V5*(-1.46341463414634*sin(θ3 - θ5) + 3.17073170731707*cos(θ3 - θ5)) - V4*V5*(-1.0*sin(θ4 - θ5) + 2.0*cos(θ4 - θ5)) - V5*V6*(1.0*sin(θ5 - θ6) + 3.0*cos(θ5 - θ6)), -V5*V6*(-1.0*sin(θ5 - θ6) - 3.0*cos(θ5 - θ6)), -V5*(-3.17073170731707*sin(θ3 - θ5) - 1.46341463414634*cos(θ3 - θ5)), -V5*(-2.0*sin(θ4 - θ5) - 1.0*cos(θ4 - θ5)), -V1*(3.11203319502075*sin(θ5) - 0.829875518672199*cos(θ5)) - V2*(-3.0*sin(θ2 - θ5) - 1.0*cos(θ2 - θ5)) - V3*(-3.17073170731707*sin(θ3 - θ5) - 1.46341463414634*cos(θ3 - θ5)) - V4*(-2.0*sin(θ4 - θ5) - 1.0*cos(θ4 - θ5)) - 10.5865803056371*V5 - V6*(3.0*sin(θ5 - θ6) - 1.0*cos(θ5 - θ6)), -V5*(3.0*sin(θ5 - θ6) - 1.0*cos(θ5 - θ6))], [-V2*V6*(1.55902004454343*sin(θ2 - θ6) - 4.4543429844098*cos(θ2 - θ6)), -V3*V6*(1.92307692307692*sin(θ3 - θ6) - 9.61538461538461*cos(θ3 - θ6)), 0, -V5*V6*(1.0*sin(θ5 - θ6) - 3.0*cos(θ5 - θ6)), -V2*V6*(-1.55902004454343*sin(θ2 - θ6) + 4.4543429844098*cos(θ2 - θ6)) - V3*V6*(-1.92307692307692*sin(θ3 - θ6) + 9.61538461538461*cos(θ3 - θ6)) - V5*V6*(-1.0*sin(θ5 - θ6) + 3.0*cos(θ5 - θ6)), -V6*(-9.61538461538461*sin(θ3 - θ6) - 1.92307692307692*cos(θ3 - θ6)), 0, -V6*(-3.0*sin(θ5 - θ6) - 1.0*cos(θ5 - θ6)), -V2*(-4.4543429844098*sin(θ2 - θ6) - 1.55902004454343*cos(θ2 - θ6)) - V3*(-9.61538461538461*sin(θ3 - θ6) - 1.92307692307692*cos(θ3 - θ6)) - V5*(-3.0*sin(θ5 - θ6) - 1.0*cos(θ5 - θ6)) - 8.96419393524071*V6], [-V2*V3*(3.84615384615385*sin(θ2 - θ3) + 0.769230769230769*cos(θ2 - θ3)), -V2*V3*(-3.84615384615385*sin(θ2 - θ3) - 0.769230769230769*cos(θ2 - θ3)) - V3*V5*(3.17073170731707*sin(θ3 - θ5) - 1.46341463414634*cos(θ3 - θ5)) - V3*V6*(9.61538461538461*sin(θ3 - θ6) - 1.92307692307692*cos(θ3 - θ6)), 0, -V3*V5*(-3.17073170731707*sin(θ3 - θ5) + 1.46341463414634*cos(θ3 - θ5)), -V3*V6*(-9.61538461538461*sin(θ3 - θ6) + 1.92307692307692*cos(θ3 - θ6)), -V2*(0.769230769230769*sin(θ2 - θ3) - 3.84615384615385*cos(θ2 - θ3)) - 33.1345403377111*V3 - V5*(-1.46341463414634*sin(θ3 - θ5) - 3.17073170731707*cos(θ3 - θ5)) - V6*(-1.92307692307692*sin(θ3 - θ6) - 9.61538461538461*cos(θ3 - θ6)), 0, -V3*(-1.46341463414634*sin(θ3 - θ5) - 3.17073170731707*cos(θ3 - θ5)), -V3*(-1.92307692307692*sin(θ3 - θ6) - 9.61538461538461*cos(θ3 - θ6))], [-V2*V4*(8.0*sin(θ2 - θ4) + 4.0*cos(θ2 - θ4)), 0, -V1*V4*(4.70588235294118*sin(θ4) - 1.17647058823529*cos(θ4)) - V2*V4*(-8.0*sin(θ2 - θ4) - 4.0*cos(θ2 - θ4)) - V4*V5*(2.0*sin(θ4 - θ5) - 1.0*cos(θ4 - θ5)), -V4*V5*(-2.0*sin(θ4 - θ5) + 1.0*cos(θ4 - θ5)), 0, 0, -V1*(-1.17647058823529*sin(θ4) - 4.70588235294118*cos(θ4)) - V2*(4.0*sin(θ2 - θ4) - 8.0*cos(θ2 - θ4)) - 29.2717647058824*V4 - V5*(-1.0*sin(θ4 - θ5) - 2.0*cos(θ4 - θ5)), -V4*(-1.0*sin(θ4 - θ5) - 2.0*cos(θ4 - θ5)), 0], [-V2*V5*(3.0*sin(θ2 - θ5) + 1.0*cos(θ2 - θ5)), -V3*V5*(3.17073170731707*sin(θ3 - θ5) + 1.46341463414634*cos(θ3 - θ5)), -V4*V5*(2.0*sin(θ4 - θ5) + 1.0*cos(θ4 - θ5)), -V1*V5*(3.11203319502075*sin(θ5) - 0.829875518672199*cos(θ5)) - V2*V5*(-3.0*sin(θ2 - θ5) - 1.0*cos(θ2 - θ5)) - V3*V5*(-3.17073170731707*sin(θ3 - θ5) - 1.46341463414634*cos(θ3 - θ5)) - V4*V5*(-2.0*sin(θ4 - θ5) - 1.0*cos(θ4 - θ5)) - V5*V6*(3.0*sin(θ5 - θ6) - 1.0*cos(θ5 - θ6)), -V5*V6*(-3.0*sin(θ5 - θ6) + 1.0*cos(θ5 - θ6)), -V5*(1.46341463414634*sin(θ3 - θ5) - 3.17073170731707*cos(θ3 - θ5)), -V5*(1.0*sin(θ4 - θ5) - 2.0*cos(θ4 - θ5)), -V1*(-0.829875518672199*sin(θ5) - 3.11203319502075*cos(θ5)) - V2*(1.0*sin(θ2 - θ5) - 3.0*cos(θ2 - θ5)) - V3*(1.46341463414634*sin(θ3 - θ5) - 3.17073170731707*cos(θ3 - θ5)) - V4*(1.0*sin(θ4 - θ5) - 2.0*cos(θ4 - θ5)) - 28.2755298046756*V5 - V6*(-1.0*sin(θ5 - θ6) - 3.0*cos(θ5 - θ6)), -V5*(-1.0*sin(θ5 - θ6) - 3.0*cos(θ5 - θ6))], [-V2*V6*(4.4543429844098*sin(θ2 - θ6) + 1.55902004454343*cos(θ2 - θ6)), -V3*V6*(9.61538461538461*sin(θ3 - θ6) + 1.92307692307692*cos(θ3 - θ6)), 0, -V5*V6*(3.0*sin(θ5 - θ6) + 1.0*cos(θ5 - θ6)), -V2*V6*(-4.4543429844098*sin(θ2 - θ6) - 1.55902004454343*cos(θ2 - θ6)) - V3*V6*(-9.61538461538461*sin(θ3 - θ6) - 1.92307692307692*cos(θ3 - θ6)) - V5*V6*(-3.0*sin(θ5 - θ6) - 1.0*cos(θ5 - θ6)), -V6*(1.92307692307692*sin(θ3 - θ6) - 9.61538461538461*cos(θ3 - θ6)), 0, -V6*(1.0*sin(θ5 - θ6) - 3.0*cos(θ5 - θ6)), -V2*(1.55902004454343*sin(θ2 - θ6) - 4.4543429844098*cos(θ2 - θ6)) - V3*(1.92307692307692*sin(θ3 - θ6) - 9.61538461538461*cos(θ3 - θ6)) - V5*(1.0*sin(θ5 - θ6) - 3.0*cos(θ5 - θ6)) - 34.0094551995888*V6]])
    elif tipo == 12:
        V3 = posicao[2]
        θ2 = x[0]
        θ3 = x[1]
        θ4 = x[2]
        θ5 = x[3]
        θ6 = x[4]
        V1 = x[5]
        V2 = x[6]
        V4 = x[7]
        V5 = x[8]
        V6 = x[9]
        ΔP2 = Pg2*(alpha + 1) - V1*V2*(4.0*sin(θ2) - 2.0*cos(θ2)) - 9.3282508137742*V2**2 - V2*V3*(3.84615384615385*sin(θ2 - θ3) - 0.769230769230769*cos(θ2 - θ3)) - V2*V4*(8.0*sin(θ2 - θ4) - 4.0*cos(θ2 - θ4)) - V2*V5*(3.0*sin(θ2 - θ5) - 1.0*cos(θ2 - θ5)) - V2*V6*(4.4543429844098*sin(θ2 - θ6) - 1.55902004454343*cos(θ2 - θ6))
        ΔP3 = Pg3*(alpha + 1) - V2*V3*(-3.84615384615385*sin(θ2 - θ3) - 0.769230769230769*cos(θ2 - θ3)) - 4.15572232645403*V3**2 - V3*V5*(3.17073170731707*sin(θ3 - θ5) - 1.46341463414634*cos(θ3 - θ5)) - V3*V6*(9.61538461538461*sin(θ3 - θ6) - 1.92307692307692*cos(θ3 - θ6))
        ΔP4 = -V1*V4*(4.70588235294118*sin(θ4) - 1.17647058823529*cos(θ4)) - V2*V4*(-8.0*sin(θ2 - θ4) - 4.0*cos(θ2 - θ4)) - 6.17647058823529*V4**2 - V4*V5*(2.0*sin(θ4 - θ5) - 1.0*cos(θ4 - θ5)) - 0.9*alpha - 0.9
        ΔP5 = -V1*V5*(3.11203319502075*sin(θ5) - 0.829875518672199*cos(θ5)) - V2*V5*(-3.0*sin(θ2 - θ5) - 1.0*cos(θ2 - θ5)) - V3*V5*(-3.17073170731707*sin(θ3 - θ5) - 1.46341463414634*cos(θ3 - θ5)) - V4*V5*(-2.0*sin(θ4 - θ5) - 1.0*cos(θ4 - θ5)) - 5.29329015281854*V5**2 - V5*V6*(3.0*sin(θ5 - θ6) - 1.0*cos(θ5 - θ6)) - alpha - 1
        ΔP6 = -V2*V6*(-4.4543429844098*sin(θ2 - θ6) - 1.55902004454343*cos(θ2 - θ6)) - V3*V6*(-9.61538461538461*sin(θ3 - θ6) - 1.92307692307692*cos(θ3 - θ6)) - V5*V6*(-3.0*sin(θ5 - θ6) - 1.0*cos(θ5 - θ6)) - 4.48209696762035*V6**2 - 0.9*alpha - 0.9
        ΔQ1 = Qg1 - 11.7479155479619*V1**2 - V1*V2*(2.0*sin(θ2) - 4.0*cos(θ2)) - V1*V4*(1.17647058823529*sin(θ4) - 4.70588235294118*cos(θ4)) - V1*V5*(0.829875518672199*sin(θ5) - 3.11203319502075*cos(θ5))
        ΔQ2 = Qg2 - V1*V2*(-2.0*sin(θ2) - 4.0*cos(θ2)) - 23.1954968305636*V2**2 - V2*V3*(-0.769230769230769*sin(θ2 - θ3) - 3.84615384615385*cos(θ2 - θ3)) - V2*V4*(-4.0*sin(θ2 - θ4) - 8.0*cos(θ2 - θ4)) - V2*V5*(-1.0*sin(θ2 - θ5) - 3.0*cos(θ2 - θ5)) - V2*V6*(-1.55902004454343*sin(θ2 - θ6) - 4.4543429844098*cos(θ2 - θ6))
        ΔQ4 = -V1*V4*(-1.17647058823529*sin(θ4) - 4.70588235294118*cos(θ4)) - V2*V4*(4.0*sin(θ2 - θ4) - 8.0*cos(θ2 - θ4)) - 14.6358823529412*V4**2 - V4*V5*(-1.0*sin(θ4 - θ5) - 2.0*cos(θ4 - θ5)) - 0.6*alpha - 0.6
        ΔQ5 = -V1*V5*(-0.829875518672199*sin(θ5) - 3.11203319502075*cos(θ5)) - V2*V5*(1.0*sin(θ2 - θ5) - 3.0*cos(θ2 - θ5)) - V3*V5*(1.46341463414634*sin(θ3 - θ5) - 3.17073170731707*cos(θ3 - θ5)) - V4*V5*(1.0*sin(θ4 - θ5) - 2.0*cos(θ4 - θ5)) - 14.1377649023378*V5**2 - V5*V6*(-1.0*sin(θ5 - θ6) - 3.0*cos(θ5 - θ6)) - 0.7*alpha - 0.7
        ΔQ6 = -V2*V6*(1.55902004454343*sin(θ2 - θ6) - 4.4543429844098*cos(θ2 - θ6)) - V3*V6*(1.92307692307692*sin(θ3 - θ6) - 9.61538461538461*cos(θ3 - θ6)) - V5*V6*(1.0*sin(θ5 - θ6) - 3.0*cos(θ5 - θ6)) - 17.0047275997944*V6**2 - 0.6*alpha - 0.6
        B = np.array([ΔP2, ΔP3, ΔP4, ΔP5, ΔP6, ΔQ1, ΔQ2, ΔQ4, ΔQ5, ΔQ6])
        A = np.array([[-V1*V2*(2.0*sin(θ2) + 4.0*cos(θ2)) - V2*V3*(0.769230769230769*sin(θ2 - θ3) + 3.84615384615385*cos(θ2 - θ3)) - V2*V4*(4.0*sin(θ2 - θ4) + 8.0*cos(θ2 - θ4)) - V2*V5*(1.0*sin(θ2 - θ5) + 3.0*cos(θ2 - θ5)) - V2*V6*(1.55902004454343*sin(θ2 - θ6) + 4.4543429844098*cos(θ2 - θ6)), -V2*V3*(-0.769230769230769*sin(θ2 - θ3) - 3.84615384615385*cos(θ2 - θ3)), -V2*V4*(-4.0*sin(θ2 - θ4) - 8.0*cos(θ2 - θ4)), -V2*V5*(-1.0*sin(θ2 - θ5) - 3.0*cos(θ2 - θ5)), -V2*V6*(-1.55902004454343*sin(θ2 - θ6) - 4.4543429844098*cos(θ2 - θ6)), -V2*(4.0*sin(θ2) - 2.0*cos(θ2)), -V1*(4.0*sin(θ2) - 2.0*cos(θ2)) - 18.6565016275484*V2 - V3*(3.84615384615385*sin(θ2 - θ3) - 0.769230769230769*cos(θ2 - θ3)) - V4*(8.0*sin(θ2 - θ4) - 4.0*cos(θ2 - θ4)) - V5*(3.0*sin(θ2 - θ5) - 1.0*cos(θ2 - θ5)) - V6*(4.4543429844098*sin(θ2 - θ6) - 1.55902004454343*cos(θ2 - θ6)), -V2*(8.0*sin(θ2 - θ4) - 4.0*cos(θ2 - θ4)), -V2*(3.0*sin(θ2 - θ5) - 1.0*cos(θ2 - θ5)), -V2*(4.4543429844098*sin(θ2 - θ6) - 1.55902004454343*cos(θ2 - θ6))], [-V2*V3*(0.769230769230769*sin(θ2 - θ3) - 3.84615384615385*cos(θ2 - θ3)), -V2*V3*(-0.769230769230769*sin(θ2 - θ3) + 3.84615384615385*cos(θ2 - θ3)) - V3*V5*(1.46341463414634*sin(θ3 - θ5) + 3.17073170731707*cos(θ3 - θ5)) - V3*V6*(1.92307692307692*sin(θ3 - θ6) + 9.61538461538461*cos(θ3 - θ6)), 0, -V3*V5*(-1.46341463414634*sin(θ3 - θ5) - 3.17073170731707*cos(θ3 - θ5)), -V3*V6*(-1.92307692307692*sin(θ3 - θ6) - 9.61538461538461*cos(θ3 - θ6)), 0, -V3*(-3.84615384615385*sin(θ2 - θ3) - 0.769230769230769*cos(θ2 - θ3)), 0, -V3*(3.17073170731707*sin(θ3 - θ5) - 1.46341463414634*cos(θ3 - θ5)), -V3*(9.61538461538461*sin(θ3 - θ6) - 1.92307692307692*cos(θ3 - θ6))], [-V2*V4*(4.0*sin(θ2 - θ4) - 8.0*cos(θ2 - θ4)), 0, -V1*V4*(1.17647058823529*sin(θ4) + 4.70588235294118*cos(θ4)) - V2*V4*(-4.0*sin(θ2 - θ4) + 8.0*cos(θ2 - θ4)) - V4*V5*(1.0*sin(θ4 - θ5) + 2.0*cos(θ4 - θ5)), -V4*V5*(-1.0*sin(θ4 - θ5) - 2.0*cos(θ4 - θ5)), 0, -V4*(4.70588235294118*sin(θ4) - 1.17647058823529*cos(θ4)), -V4*(-8.0*sin(θ2 - θ4) - 4.0*cos(θ2 - θ4)), -V1*(4.70588235294118*sin(θ4) - 1.17647058823529*cos(θ4)) - V2*(-8.0*sin(θ2 - θ4) - 4.0*cos(θ2 - θ4)) - 12.3529411764706*V4 - V5*(2.0*sin(θ4 - θ5) - 1.0*cos(θ4 - θ5)), -V4*(2.0*sin(θ4 - θ5) - 1.0*cos(θ4 - θ5)), 0], [-V2*V5*(1.0*sin(θ2 - θ5) - 3.0*cos(θ2 - θ5)), -V3*V5*(1.46341463414634*sin(θ3 - θ5) - 3.17073170731707*cos(θ3 - θ5)), -V4*V5*(1.0*sin(θ4 - θ5) - 2.0*cos(θ4 - θ5)), -V1*V5*(0.829875518672199*sin(θ5) + 3.11203319502075*cos(θ5)) - V2*V5*(-1.0*sin(θ2 - θ5) + 3.0*cos(θ2 - θ5)) - V3*V5*(-1.46341463414634*sin(θ3 - θ5) + 3.17073170731707*cos(θ3 - θ5)) - V4*V5*(-1.0*sin(θ4 - θ5) + 2.0*cos(θ4 - θ5)) - V5*V6*(1.0*sin(θ5 - θ6) + 3.0*cos(θ5 - θ6)), -V5*V6*(-1.0*sin(θ5 - θ6) - 3.0*cos(θ5 - θ6)), -V5*(3.11203319502075*sin(θ5) - 0.829875518672199*cos(θ5)), -V5*(-3.0*sin(θ2 - θ5) - 1.0*cos(θ2 - θ5)), -V5*(-2.0*sin(θ4 - θ5) - 1.0*cos(θ4 - θ5)), -V1*(3.11203319502075*sin(θ5) - 0.829875518672199*cos(θ5)) - V2*(-3.0*sin(θ2 - θ5) - 1.0*cos(θ2 - θ5)) - V3*(-3.17073170731707*sin(θ3 - θ5) - 1.46341463414634*cos(θ3 - θ5)) - V4*(-2.0*sin(θ4 - θ5) - 1.0*cos(θ4 - θ5)) - 10.5865803056371*V5 - V6*(3.0*sin(θ5 - θ6) - 1.0*cos(θ5 - θ6)), -V5*(3.0*sin(θ5 - θ6) - 1.0*cos(θ5 - θ6))], [-V2*V6*(1.55902004454343*sin(θ2 - θ6) - 4.4543429844098*cos(θ2 - θ6)), -V3*V6*(1.92307692307692*sin(θ3 - θ6) - 9.61538461538461*cos(θ3 - θ6)), 0, -V5*V6*(1.0*sin(θ5 - θ6) - 3.0*cos(θ5 - θ6)), -V2*V6*(-1.55902004454343*sin(θ2 - θ6) + 4.4543429844098*cos(θ2 - θ6)) - V3*V6*(-1.92307692307692*sin(θ3 - θ6) + 9.61538461538461*cos(θ3 - θ6)) - V5*V6*(-1.0*sin(θ5 - θ6) + 3.0*cos(θ5 - θ6)), 0, -V6*(-4.4543429844098*sin(θ2 - θ6) - 1.55902004454343*cos(θ2 - θ6)), 0, -V6*(-3.0*sin(θ5 - θ6) - 1.0*cos(θ5 - θ6)), -V2*(-4.4543429844098*sin(θ2 - θ6) - 1.55902004454343*cos(θ2 - θ6)) - V3*(-9.61538461538461*sin(θ3 - θ6) - 1.92307692307692*cos(θ3 - θ6)) - V5*(-3.0*sin(θ5 - θ6) - 1.0*cos(θ5 - θ6)) - 8.96419393524071*V6], [-V1*V2*(4.0*sin(θ2) + 2.0*cos(θ2)), 0, -V1*V4*(4.70588235294118*sin(θ4) + 1.17647058823529*cos(θ4)), -V1*V5*(3.11203319502075*sin(θ5) + 0.829875518672199*cos(θ5)), 0, -23.4958310959238*V1 - V2*(2.0*sin(θ2) - 4.0*cos(θ2)) - V4*(1.17647058823529*sin(θ4) - 4.70588235294118*cos(θ4)) - V5*(0.829875518672199*sin(θ5) - 3.11203319502075*cos(θ5)), -V1*(2.0*sin(θ2) - 4.0*cos(θ2)), -V1*(1.17647058823529*sin(θ4) - 4.70588235294118*cos(θ4)), -V1*(0.829875518672199*sin(θ5) - 3.11203319502075*cos(θ5)), 0], [-V1*V2*(4.0*sin(θ2) - 2.0*cos(θ2)) - V2*V3*(3.84615384615385*sin(θ2 - θ3) - 0.769230769230769*cos(θ2 - θ3)) - V2*V4*(8.0*sin(θ2 - θ4) - 4.0*cos(θ2 - θ4)) - V2*V5*(3.0*sin(θ2 - θ5) - 1.0*cos(θ2 - θ5)) - V2*V6*(4.4543429844098*sin(θ2 - θ6) - 1.55902004454343*cos(θ2 - θ6)), -V2*V3*(-3.84615384615385*sin(θ2 - θ3) + 0.769230769230769*cos(θ2 - θ3)), -V2*V4*(-8.0*sin(θ2 - θ4) + 4.0*cos(θ2 - θ4)), -V2*V5*(-3.0*sin(θ2 - θ5) + 1.0*cos(θ2 - θ5)), -V2*V6*(-4.4543429844098*sin(θ2 - θ6) + 1.55902004454343*cos(θ2 - θ6)), -V2*(-2.0*sin(θ2) - 4.0*cos(θ2)), -V1*(-2.0*sin(θ2) - 4.0*cos(θ2)) - 46.3909936611273*V2 - V3*(-0.769230769230769*sin(θ2 - θ3) - 3.84615384615385*cos(θ2 - θ3)) - V4*(-4.0*sin(θ2 - θ4) - 8.0*cos(θ2 - θ4)) - V5*(-1.0*sin(θ2 - θ5) - 3.0*cos(θ2 - θ5)) - V6*(-1.55902004454343*sin(θ2 - θ6) - 4.4543429844098*cos(θ2 - θ6)), -V2*(-4.0*sin(θ2 - θ4) - 8.0*cos(θ2 - θ4)), -V2*(-1.0*sin(θ2 - θ5) - 3.0*cos(θ2 - θ5)), -V2*(-1.55902004454343*sin(θ2 - θ6) - 4.4543429844098*cos(θ2 - θ6))], [-V2*V4*(8.0*sin(θ2 - θ4) + 4.0*cos(θ2 - θ4)), 0, -V1*V4*(4.70588235294118*sin(θ4) - 1.17647058823529*cos(θ4)) - V2*V4*(-8.0*sin(θ2 - θ4) - 4.0*cos(θ2 - θ4)) - V4*V5*(2.0*sin(θ4 - θ5) - 1.0*cos(θ4 - θ5)), -V4*V5*(-2.0*sin(θ4 - θ5) + 1.0*cos(θ4 - θ5)), 0, -V4*(-1.17647058823529*sin(θ4) - 4.70588235294118*cos(θ4)), -V4*(4.0*sin(θ2 - θ4) - 8.0*cos(θ2 - θ4)), -V1*(-1.17647058823529*sin(θ4) - 4.70588235294118*cos(θ4)) - V2*(4.0*sin(θ2 - θ4) - 8.0*cos(θ2 - θ4)) - 29.2717647058824*V4 - V5*(-1.0*sin(θ4 - θ5) - 2.0*cos(θ4 - θ5)), -V4*(-1.0*sin(θ4 - θ5) - 2.0*cos(θ4 - θ5)), 0], [-V2*V5*(3.0*sin(θ2 - θ5) + 1.0*cos(θ2 - θ5)), -V3*V5*(3.17073170731707*sin(θ3 - θ5) + 1.46341463414634*cos(θ3 - θ5)), -V4*V5*(2.0*sin(θ4 - θ5) + 1.0*cos(θ4 - θ5)), -V1*V5*(3.11203319502075*sin(θ5) - 0.829875518672199*cos(θ5)) - V2*V5*(-3.0*sin(θ2 - θ5) - 1.0*cos(θ2 - θ5)) - V3*V5*(-3.17073170731707*sin(θ3 - θ5) - 1.46341463414634*cos(θ3 - θ5)) - V4*V5*(-2.0*sin(θ4 - θ5) - 1.0*cos(θ4 - θ5)) - V5*V6*(3.0*sin(θ5 - θ6) - 1.0*cos(θ5 - θ6)), -V5*V6*(-3.0*sin(θ5 - θ6) + 1.0*cos(θ5 - θ6)), -V5*(-0.829875518672199*sin(θ5) - 3.11203319502075*cos(θ5)), -V5*(1.0*sin(θ2 - θ5) - 3.0*cos(θ2 - θ5)), -V5*(1.0*sin(θ4 - θ5) - 2.0*cos(θ4 - θ5)), -V1*(-0.829875518672199*sin(θ5) - 3.11203319502075*cos(θ5)) - V2*(1.0*sin(θ2 - θ5) - 3.0*cos(θ2 - θ5)) - V3*(1.46341463414634*sin(θ3 - θ5) - 3.17073170731707*cos(θ3 - θ5)) - V4*(1.0*sin(θ4 - θ5) - 2.0*cos(θ4 - θ5)) - 28.2755298046756*V5 - V6*(-1.0*sin(θ5 - θ6) - 3.0*cos(θ5 - θ6)), -V5*(-1.0*sin(θ5 - θ6) - 3.0*cos(θ5 - θ6))], [-V2*V6*(4.4543429844098*sin(θ2 - θ6) + 1.55902004454343*cos(θ2 - θ6)), -V3*V6*(9.61538461538461*sin(θ3 - θ6) + 1.92307692307692*cos(θ3 - θ6)), 0, -V5*V6*(3.0*sin(θ5 - θ6) + 1.0*cos(θ5 - θ6)), -V2*V6*(-4.4543429844098*sin(θ2 - θ6) - 1.55902004454343*cos(θ2 - θ6)) - V3*V6*(-9.61538461538461*sin(θ3 - θ6) - 1.92307692307692*cos(θ3 - θ6)) - V5*V6*(-3.0*sin(θ5 - θ6) - 1.0*cos(θ5 - θ6)), 0, -V6*(1.55902004454343*sin(θ2 - θ6) - 4.4543429844098*cos(θ2 - θ6)), 0, -V6*(1.0*sin(θ5 - θ6) - 3.0*cos(θ5 - θ6)), -V2*(1.55902004454343*sin(θ2 - θ6) - 4.4543429844098*cos(θ2 - θ6)) - V3*(1.92307692307692*sin(θ3 - θ6) - 9.61538461538461*cos(θ3 - θ6)) - V5*(1.0*sin(θ5 - θ6) - 3.0*cos(θ5 - θ6)) - 34.0094551995888*V6]])
    elif tipo == 13:
        V2 = posicao[1]
        θ2 = x[0]
        θ3 = x[1]
        θ4 = x[2]
        θ5 = x[3]
        θ6 = x[4]
        V1 = x[5]
        V3 = x[6]
        V4 = x[7]
        V5 = x[8]
        V6 = x[9]
        ΔP2 = Pg2*(alpha + 1) - V1*V2*(4.0*sin(θ2) - 2.0*cos(θ2)) - 9.3282508137742*V2**2 - V2*V3*(3.84615384615385*sin(θ2 - θ3) - 0.769230769230769*cos(θ2 - θ3)) - V2*V4*(8.0*sin(θ2 - θ4) - 4.0*cos(θ2 - θ4)) - V2*V5*(3.0*sin(θ2 - θ5) - 1.0*cos(θ2 - θ5)) - V2*V6*(4.4543429844098*sin(θ2 - θ6) - 1.55902004454343*cos(θ2 - θ6))
        ΔP3 = Pg3*(alpha + 1) - V2*V3*(-3.84615384615385*sin(θ2 - θ3) - 0.769230769230769*cos(θ2 - θ3)) - 4.15572232645403*V3**2 - V3*V5*(3.17073170731707*sin(θ3 - θ5) - 1.46341463414634*cos(θ3 - θ5)) - V3*V6*(9.61538461538461*sin(θ3 - θ6) - 1.92307692307692*cos(θ3 - θ6))
        ΔP4 = -V1*V4*(4.70588235294118*sin(θ4) - 1.17647058823529*cos(θ4)) - V2*V4*(-8.0*sin(θ2 - θ4) - 4.0*cos(θ2 - θ4)) - 6.17647058823529*V4**2 - V4*V5*(2.0*sin(θ4 - θ5) - 1.0*cos(θ4 - θ5)) - 0.9*alpha - 0.9
        ΔP5 = -V1*V5*(3.11203319502075*sin(θ5) - 0.829875518672199*cos(θ5)) - V2*V5*(-3.0*sin(θ2 - θ5) - 1.0*cos(θ2 - θ5)) - V3*V5*(-3.17073170731707*sin(θ3 - θ5) - 1.46341463414634*cos(θ3 - θ5)) - V4*V5*(-2.0*sin(θ4 - θ5) - 1.0*cos(θ4 - θ5)) - 5.29329015281854*V5**2 - V5*V6*(3.0*sin(θ5 - θ6) - 1.0*cos(θ5 - θ6)) - alpha - 1
        ΔP6 = -V2*V6*(-4.4543429844098*sin(θ2 - θ6) - 1.55902004454343*cos(θ2 - θ6)) - V3*V6*(-9.61538461538461*sin(θ3 - θ6) - 1.92307692307692*cos(θ3 - θ6)) - V5*V6*(-3.0*sin(θ5 - θ6) - 1.0*cos(θ5 - θ6)) - 4.48209696762035*V6**2 - 0.9*alpha - 0.9
        ΔQ1 = Qg1 - 11.7479155479619*V1**2 - V1*V2*(2.0*sin(θ2) - 4.0*cos(θ2)) - V1*V4*(1.17647058823529*sin(θ4) - 4.70588235294118*cos(θ4)) - V1*V5*(0.829875518672199*sin(θ5) - 3.11203319502075*cos(θ5))
        ΔQ3 = Qg3 - V2*V3*(0.769230769230769*sin(θ2 - θ3) - 3.84615384615385*cos(θ2 - θ3)) - 16.5672701688555*V3**2 - V3*V5*(-1.46341463414634*sin(θ3 - θ5) - 3.17073170731707*cos(θ3 - θ5)) - V3*V6*(-1.92307692307692*sin(θ3 - θ6) - 9.61538461538461*cos(θ3 - θ6))
        ΔQ4 = -V1*V4*(-1.17647058823529*sin(θ4) - 4.70588235294118*cos(θ4)) - V2*V4*(4.0*sin(θ2 - θ4) - 8.0*cos(θ2 - θ4)) - 14.6358823529412*V4**2 - V4*V5*(-1.0*sin(θ4 - θ5) - 2.0*cos(θ4 - θ5)) - 0.6*alpha - 0.6
        ΔQ5 = -V1*V5*(-0.829875518672199*sin(θ5) - 3.11203319502075*cos(θ5)) - V2*V5*(1.0*sin(θ2 - θ5) - 3.0*cos(θ2 - θ5)) - V3*V5*(1.46341463414634*sin(θ3 - θ5) - 3.17073170731707*cos(θ3 - θ5)) - V4*V5*(1.0*sin(θ4 - θ5) - 2.0*cos(θ4 - θ5)) - 14.1377649023378*V5**2 - V5*V6*(-1.0*sin(θ5 - θ6) - 3.0*cos(θ5 - θ6)) - 0.7*alpha - 0.7
        ΔQ6 = -V2*V6*(1.55902004454343*sin(θ2 - θ6) - 4.4543429844098*cos(θ2 - θ6)) - V3*V6*(1.92307692307692*sin(θ3 - θ6) - 9.61538461538461*cos(θ3 - θ6)) - V5*V6*(1.0*sin(θ5 - θ6) - 3.0*cos(θ5 - θ6)) - 17.0047275997944*V6**2 - 0.6*alpha - 0.6
        B = np.array([ΔP2, ΔP3, ΔP4, ΔP5, ΔP6, ΔQ1, ΔQ3, ΔQ4, ΔQ5, ΔQ6])
        A = np.array([[-V1*V2*(2.0*sin(θ2) + 4.0*cos(θ2)) - V2*V3*(0.769230769230769*sin(θ2 - θ3) + 3.84615384615385*cos(θ2 - θ3)) - V2*V4*(4.0*sin(θ2 - θ4) + 8.0*cos(θ2 - θ4)) - V2*V5*(1.0*sin(θ2 - θ5) + 3.0*cos(θ2 - θ5)) - V2*V6*(1.55902004454343*sin(θ2 - θ6) + 4.4543429844098*cos(θ2 - θ6)), -V2*V3*(-0.769230769230769*sin(θ2 - θ3) - 3.84615384615385*cos(θ2 - θ3)), -V2*V4*(-4.0*sin(θ2 - θ4) - 8.0*cos(θ2 - θ4)), -V2*V5*(-1.0*sin(θ2 - θ5) - 3.0*cos(θ2 - θ5)), -V2*V6*(-1.55902004454343*sin(θ2 - θ6) - 4.4543429844098*cos(θ2 - θ6)), -V2*(4.0*sin(θ2) - 2.0*cos(θ2)), -V2*(3.84615384615385*sin(θ2 - θ3) - 0.769230769230769*cos(θ2 - θ3)), -V2*(8.0*sin(θ2 - θ4) - 4.0*cos(θ2 - θ4)), -V2*(3.0*sin(θ2 - θ5) - 1.0*cos(θ2 - θ5)), -V2*(4.4543429844098*sin(θ2 - θ6) - 1.55902004454343*cos(θ2 - θ6))], [-V2*V3*(0.769230769230769*sin(θ2 - θ3) - 3.84615384615385*cos(θ2 - θ3)), -V2*V3*(-0.769230769230769*sin(θ2 - θ3) + 3.84615384615385*cos(θ2 - θ3)) - V3*V5*(1.46341463414634*sin(θ3 - θ5) + 3.17073170731707*cos(θ3 - θ5)) - V3*V6*(1.92307692307692*sin(θ3 - θ6) + 9.61538461538461*cos(θ3 - θ6)), 0, -V3*V5*(-1.46341463414634*sin(θ3 - θ5) - 3.17073170731707*cos(θ3 - θ5)), -V3*V6*(-1.92307692307692*sin(θ3 - θ6) - 9.61538461538461*cos(θ3 - θ6)), 0, -V2*(-3.84615384615385*sin(θ2 - θ3) - 0.769230769230769*cos(θ2 - θ3)) - 8.31144465290807*V3 - V5*(3.17073170731707*sin(θ3 - θ5) - 1.46341463414634*cos(θ3 - θ5)) - V6*(9.61538461538461*sin(θ3 - θ6) - 1.92307692307692*cos(θ3 - θ6)), 0, -V3*(3.17073170731707*sin(θ3 - θ5) - 1.46341463414634*cos(θ3 - θ5)), -V3*(9.61538461538461*sin(θ3 - θ6) - 1.92307692307692*cos(θ3 - θ6))], [-V2*V4*(4.0*sin(θ2 - θ4) - 8.0*cos(θ2 - θ4)), 0, -V1*V4*(1.17647058823529*sin(θ4) + 4.70588235294118*cos(θ4)) - V2*V4*(-4.0*sin(θ2 - θ4) + 8.0*cos(θ2 - θ4)) - V4*V5*(1.0*sin(θ4 - θ5) + 2.0*cos(θ4 - θ5)), -V4*V5*(-1.0*sin(θ4 - θ5) - 2.0*cos(θ4 - θ5)), 0, -V4*(4.70588235294118*sin(θ4) - 1.17647058823529*cos(θ4)), 0, -V1*(4.70588235294118*sin(θ4) - 1.17647058823529*cos(θ4)) - V2*(-8.0*sin(θ2 - θ4) - 4.0*cos(θ2 - θ4)) - 12.3529411764706*V4 - V5*(2.0*sin(θ4 - θ5) - 1.0*cos(θ4 - θ5)), -V4*(2.0*sin(θ4 - θ5) - 1.0*cos(θ4 - θ5)), 0], [-V2*V5*(1.0*sin(θ2 - θ5) - 3.0*cos(θ2 - θ5)), -V3*V5*(1.46341463414634*sin(θ3 - θ5) - 3.17073170731707*cos(θ3 - θ5)), -V4*V5*(1.0*sin(θ4 - θ5) - 2.0*cos(θ4 - θ5)), -V1*V5*(0.829875518672199*sin(θ5) + 3.11203319502075*cos(θ5)) - V2*V5*(-1.0*sin(θ2 - θ5) + 3.0*cos(θ2 - θ5)) - V3*V5*(-1.46341463414634*sin(θ3 - θ5) + 3.17073170731707*cos(θ3 - θ5)) - V4*V5*(-1.0*sin(θ4 - θ5) + 2.0*cos(θ4 - θ5)) - V5*V6*(1.0*sin(θ5 - θ6) + 3.0*cos(θ5 - θ6)), -V5*V6*(-1.0*sin(θ5 - θ6) - 3.0*cos(θ5 - θ6)), -V5*(3.11203319502075*sin(θ5) - 0.829875518672199*cos(θ5)), -V5*(-3.17073170731707*sin(θ3 - θ5) - 1.46341463414634*cos(θ3 - θ5)), -V5*(-2.0*sin(θ4 - θ5) - 1.0*cos(θ4 - θ5)), -V1*(3.11203319502075*sin(θ5) - 0.829875518672199*cos(θ5)) - V2*(-3.0*sin(θ2 - θ5) - 1.0*cos(θ2 - θ5)) - V3*(-3.17073170731707*sin(θ3 - θ5) - 1.46341463414634*cos(θ3 - θ5)) - V4*(-2.0*sin(θ4 - θ5) - 1.0*cos(θ4 - θ5)) - 10.5865803056371*V5 - V6*(3.0*sin(θ5 - θ6) - 1.0*cos(θ5 - θ6)), -V5*(3.0*sin(θ5 - θ6) - 1.0*cos(θ5 - θ6))], [-V2*V6*(1.55902004454343*sin(θ2 - θ6) - 4.4543429844098*cos(θ2 - θ6)), -V3*V6*(1.92307692307692*sin(θ3 - θ6) - 9.61538461538461*cos(θ3 - θ6)), 0, -V5*V6*(1.0*sin(θ5 - θ6) - 3.0*cos(θ5 - θ6)), -V2*V6*(-1.55902004454343*sin(θ2 - θ6) + 4.4543429844098*cos(θ2 - θ6)) - V3*V6*(-1.92307692307692*sin(θ3 - θ6) + 9.61538461538461*cos(θ3 - θ6)) - V5*V6*(-1.0*sin(θ5 - θ6) + 3.0*cos(θ5 - θ6)), 0, -V6*(-9.61538461538461*sin(θ3 - θ6) - 1.92307692307692*cos(θ3 - θ6)), 0, -V6*(-3.0*sin(θ5 - θ6) - 1.0*cos(θ5 - θ6)), -V2*(-4.4543429844098*sin(θ2 - θ6) - 1.55902004454343*cos(θ2 - θ6)) - V3*(-9.61538461538461*sin(θ3 - θ6) - 1.92307692307692*cos(θ3 - θ6)) - V5*(-3.0*sin(θ5 - θ6) - 1.0*cos(θ5 - θ6)) - 8.96419393524071*V6], [-V1*V2*(4.0*sin(θ2) + 2.0*cos(θ2)), 0, -V1*V4*(4.70588235294118*sin(θ4) + 1.17647058823529*cos(θ4)), -V1*V5*(3.11203319502075*sin(θ5) + 0.829875518672199*cos(θ5)), 0, -23.4958310959238*V1 - V2*(2.0*sin(θ2) - 4.0*cos(θ2)) - V4*(1.17647058823529*sin(θ4) - 4.70588235294118*cos(θ4)) - V5*(0.829875518672199*sin(θ5) - 3.11203319502075*cos(θ5)), 0, -V1*(1.17647058823529*sin(θ4) - 4.70588235294118*cos(θ4)), -V1*(0.829875518672199*sin(θ5) - 3.11203319502075*cos(θ5)), 0], [-V2*V3*(3.84615384615385*sin(θ2 - θ3) + 0.769230769230769*cos(θ2 - θ3)), -V2*V3*(-3.84615384615385*sin(θ2 - θ3) - 0.769230769230769*cos(θ2 - θ3)) - V3*V5*(3.17073170731707*sin(θ3 - θ5) - 1.46341463414634*cos(θ3 - θ5)) - V3*V6*(9.61538461538461*sin(θ3 - θ6) - 1.92307692307692*cos(θ3 - θ6)), 0, -V3*V5*(-3.17073170731707*sin(θ3 - θ5) + 1.46341463414634*cos(θ3 - θ5)), -V3*V6*(-9.61538461538461*sin(θ3 - θ6) + 1.92307692307692*cos(θ3 - θ6)), 0, -V2*(0.769230769230769*sin(θ2 - θ3) - 3.84615384615385*cos(θ2 - θ3)) - 33.1345403377111*V3 - V5*(-1.46341463414634*sin(θ3 - θ5) - 3.17073170731707*cos(θ3 - θ5)) - V6*(-1.92307692307692*sin(θ3 - θ6) - 9.61538461538461*cos(θ3 - θ6)), 0, -V3*(-1.46341463414634*sin(θ3 - θ5) - 3.17073170731707*cos(θ3 - θ5)), -V3*(-1.92307692307692*sin(θ3 - θ6) - 9.61538461538461*cos(θ3 - θ6))], [-V2*V4*(8.0*sin(θ2 - θ4) + 4.0*cos(θ2 - θ4)), 0, -V1*V4*(4.70588235294118*sin(θ4) - 1.17647058823529*cos(θ4)) - V2*V4*(-8.0*sin(θ2 - θ4) - 4.0*cos(θ2 - θ4)) - V4*V5*(2.0*sin(θ4 - θ5) - 1.0*cos(θ4 - θ5)), -V4*V5*(-2.0*sin(θ4 - θ5) + 1.0*cos(θ4 - θ5)), 0, -V4*(-1.17647058823529*sin(θ4) - 4.70588235294118*cos(θ4)), 0, -V1*(-1.17647058823529*sin(θ4) - 4.70588235294118*cos(θ4)) - V2*(4.0*sin(θ2 - θ4) - 8.0*cos(θ2 - θ4)) - 29.2717647058824*V4 - V5*(-1.0*sin(θ4 - θ5) - 2.0*cos(θ4 - θ5)), -V4*(-1.0*sin(θ4 - θ5) - 2.0*cos(θ4 - θ5)), 0], [-V2*V5*(3.0*sin(θ2 - θ5) + 1.0*cos(θ2 - θ5)), -V3*V5*(3.17073170731707*sin(θ3 - θ5) + 1.46341463414634*cos(θ3 - θ5)), -V4*V5*(2.0*sin(θ4 - θ5) + 1.0*cos(θ4 - θ5)), -V1*V5*(3.11203319502075*sin(θ5) - 0.829875518672199*cos(θ5)) - V2*V5*(-3.0*sin(θ2 - θ5) - 1.0*cos(θ2 - θ5)) - V3*V5*(-3.17073170731707*sin(θ3 - θ5) - 1.46341463414634*cos(θ3 - θ5)) - V4*V5*(-2.0*sin(θ4 - θ5) - 1.0*cos(θ4 - θ5)) - V5*V6*(3.0*sin(θ5 - θ6) - 1.0*cos(θ5 - θ6)), -V5*V6*(-3.0*sin(θ5 - θ6) + 1.0*cos(θ5 - θ6)), -V5*(-0.829875518672199*sin(θ5) - 3.11203319502075*cos(θ5)), -V5*(1.46341463414634*sin(θ3 - θ5) - 3.17073170731707*cos(θ3 - θ5)), -V5*(1.0*sin(θ4 - θ5) - 2.0*cos(θ4 - θ5)), -V1*(-0.829875518672199*sin(θ5) - 3.11203319502075*cos(θ5)) - V2*(1.0*sin(θ2 - θ5) - 3.0*cos(θ2 - θ5)) - V3*(1.46341463414634*sin(θ3 - θ5) - 3.17073170731707*cos(θ3 - θ5)) - V4*(1.0*sin(θ4 - θ5) - 2.0*cos(θ4 - θ5)) - 28.2755298046756*V5 - V6*(-1.0*sin(θ5 - θ6) - 3.0*cos(θ5 - θ6)), -V5*(-1.0*sin(θ5 - θ6) - 3.0*cos(θ5 - θ6))], [-V2*V6*(4.4543429844098*sin(θ2 - θ6) + 1.55902004454343*cos(θ2 - θ6)), -V3*V6*(9.61538461538461*sin(θ3 - θ6) + 1.92307692307692*cos(θ3 - θ6)), 0, -V5*V6*(3.0*sin(θ5 - θ6) + 1.0*cos(θ5 - θ6)), -V2*V6*(-4.4543429844098*sin(θ2 - θ6) - 1.55902004454343*cos(θ2 - θ6)) - V3*V6*(-9.61538461538461*sin(θ3 - θ6) - 1.92307692307692*cos(θ3 - θ6)) - V5*V6*(-3.0*sin(θ5 - θ6) - 1.0*cos(θ5 - θ6)), 0, -V6*(1.92307692307692*sin(θ3 - θ6) - 9.61538461538461*cos(θ3 - θ6)), 0, -V6*(1.0*sin(θ5 - θ6) - 3.0*cos(θ5 - θ6)), -V2*(1.55902004454343*sin(θ2 - θ6) - 4.4543429844098*cos(θ2 - θ6)) - V3*(1.92307692307692*sin(θ3 - θ6) - 9.61538461538461*cos(θ3 - θ6)) - V5*(1.0*sin(θ5 - θ6) - 3.0*cos(θ5 - θ6)) - 34.0094551995888*V6]])
    else:
        V1 = posicao[0]
        θ2 = x[0]
        θ3 = x[1]
        θ4 = x[2]
        θ5 = x[3]
        θ6 = x[4]
        V2 = x[5]
        V3 = x[6]
        V4 = x[7]
        V5 = x[8]
        V6 = x[9]
        ΔP2 = Pg2*(alpha + 1) - V1*V2*(4.0*sin(θ2) - 2.0*cos(θ2)) - 9.3282508137742*V2**2 - V2*V3*(3.84615384615385*sin(θ2 - θ3) - 0.769230769230769*cos(θ2 - θ3)) - V2*V4*(8.0*sin(θ2 - θ4) - 4.0*cos(θ2 - θ4)) - V2*V5*(3.0*sin(θ2 - θ5) - 1.0*cos(θ2 - θ5)) - V2*V6*(4.4543429844098*sin(θ2 - θ6) - 1.55902004454343*cos(θ2 - θ6))
        ΔP3 = Pg3*(alpha + 1) - V2*V3*(-3.84615384615385*sin(θ2 - θ3) - 0.769230769230769*cos(θ2 - θ3)) - 4.15572232645403*V3**2 - V3*V5*(3.17073170731707*sin(θ3 - θ5) - 1.46341463414634*cos(θ3 - θ5)) - V3*V6*(9.61538461538461*sin(θ3 - θ6) - 1.92307692307692*cos(θ3 - θ6))
        ΔP4 = -V1*V4*(4.70588235294118*sin(θ4) - 1.17647058823529*cos(θ4)) - V2*V4*(-8.0*sin(θ2 - θ4) - 4.0*cos(θ2 - θ4)) - 6.17647058823529*V4**2 - V4*V5*(2.0*sin(θ4 - θ5) - 1.0*cos(θ4 - θ5)) - 0.9*alpha - 0.9
        ΔP5 = -V1*V5*(3.11203319502075*sin(θ5) - 0.829875518672199*cos(θ5)) - V2*V5*(-3.0*sin(θ2 - θ5) - 1.0*cos(θ2 - θ5)) - V3*V5*(-3.17073170731707*sin(θ3 - θ5) - 1.46341463414634*cos(θ3 - θ5)) - V4*V5*(-2.0*sin(θ4 - θ5) - 1.0*cos(θ4 - θ5)) - 5.29329015281854*V5**2 - V5*V6*(3.0*sin(θ5 - θ6) - 1.0*cos(θ5 - θ6)) - alpha - 1
        ΔP6 = -V2*V6*(-4.4543429844098*sin(θ2 - θ6) - 1.55902004454343*cos(θ2 - θ6)) - V3*V6*(-9.61538461538461*sin(θ3 - θ6) - 1.92307692307692*cos(θ3 - θ6)) - V5*V6*(-3.0*sin(θ5 - θ6) - 1.0*cos(θ5 - θ6)) - 4.48209696762035*V6**2 - 0.9*alpha - 0.9
        ΔQ2 = Qg2 - V1*V2*(-2.0*sin(θ2) - 4.0*cos(θ2)) - 23.1954968305636*V2**2 - V2*V3*(-0.769230769230769*sin(θ2 - θ3) - 3.84615384615385*cos(θ2 - θ3)) - V2*V4*(-4.0*sin(θ2 - θ4) - 8.0*cos(θ2 - θ4)) - V2*V5*(-1.0*sin(θ2 - θ5) - 3.0*cos(θ2 - θ5)) - V2*V6*(-1.55902004454343*sin(θ2 - θ6) - 4.4543429844098*cos(θ2 - θ6))
        ΔQ3 = Qg3 - V2*V3*(0.769230769230769*sin(θ2 - θ3) - 3.84615384615385*cos(θ2 - θ3)) - 16.5672701688555*V3**2 - V3*V5*(-1.46341463414634*sin(θ3 - θ5) - 3.17073170731707*cos(θ3 - θ5)) - V3*V6*(-1.92307692307692*sin(θ3 - θ6) - 9.61538461538461*cos(θ3 - θ6))
        ΔQ4 = -V1*V4*(-1.17647058823529*sin(θ4) - 4.70588235294118*cos(θ4)) - V2*V4*(4.0*sin(θ2 - θ4) - 8.0*cos(θ2 - θ4)) - 14.6358823529412*V4**2 - V4*V5*(-1.0*sin(θ4 - θ5) - 2.0*cos(θ4 - θ5)) - 0.6*alpha - 0.6
        ΔQ5 = -V1*V5*(-0.829875518672199*sin(θ5) - 3.11203319502075*cos(θ5)) - V2*V5*(1.0*sin(θ2 - θ5) - 3.0*cos(θ2 - θ5)) - V3*V5*(1.46341463414634*sin(θ3 - θ5) - 3.17073170731707*cos(θ3 - θ5)) - V4*V5*(1.0*sin(θ4 - θ5) - 2.0*cos(θ4 - θ5)) - 14.1377649023378*V5**2 - V5*V6*(-1.0*sin(θ5 - θ6) - 3.0*cos(θ5 - θ6)) - 0.7*alpha - 0.7
        ΔQ6 = -V2*V6*(1.55902004454343*sin(θ2 - θ6) - 4.4543429844098*cos(θ2 - θ6)) - V3*V6*(1.92307692307692*sin(θ3 - θ6) - 9.61538461538461*cos(θ3 - θ6)) - V5*V6*(1.0*sin(θ5 - θ6) - 3.0*cos(θ5 - θ6)) - 17.0047275997944*V6**2 - 0.6*alpha - 0.6
        B = np.array([ΔP2, ΔP3, ΔP4, ΔP5, ΔP6, ΔQ2, ΔQ3, ΔQ4, ΔQ5, ΔQ6])
        A = np.array([[-V1*V2*(2.0*sin(θ2) + 4.0*cos(θ2)) - V2*V3*(0.769230769230769*sin(θ2 - θ3) + 3.84615384615385*cos(θ2 - θ3)) - V2*V4*(4.0*sin(θ2 - θ4) + 8.0*cos(θ2 - θ4)) - V2*V5*(1.0*sin(θ2 - θ5) + 3.0*cos(θ2 - θ5)) - V2*V6*(1.55902004454343*sin(θ2 - θ6) + 4.4543429844098*cos(θ2 - θ6)), -V2*V3*(-0.769230769230769*sin(θ2 - θ3) - 3.84615384615385*cos(θ2 - θ3)), -V2*V4*(-4.0*sin(θ2 - θ4) - 8.0*cos(θ2 - θ4)), -V2*V5*(-1.0*sin(θ2 - θ5) - 3.0*cos(θ2 - θ5)), -V2*V6*(-1.55902004454343*sin(θ2 - θ6) - 4.4543429844098*cos(θ2 - θ6)), -V1*(4.0*sin(θ2) - 2.0*cos(θ2)) - 18.6565016275484*V2 - V3*(3.84615384615385*sin(θ2 - θ3) - 0.769230769230769*cos(θ2 - θ3)) - V4*(8.0*sin(θ2 - θ4) - 4.0*cos(θ2 - θ4)) - V5*(3.0*sin(θ2 - θ5) - 1.0*cos(θ2 - θ5)) - V6*(4.4543429844098*sin(θ2 - θ6) - 1.55902004454343*cos(θ2 - θ6)), -V2*(3.84615384615385*sin(θ2 - θ3) - 0.769230769230769*cos(θ2 - θ3)), -V2*(8.0*sin(θ2 - θ4) - 4.0*cos(θ2 - θ4)), -V2*(3.0*sin(θ2 - θ5) - 1.0*cos(θ2 - θ5)), -V2*(4.4543429844098*sin(θ2 - θ6) - 1.55902004454343*cos(θ2 - θ6))], [-V2*V3*(0.769230769230769*sin(θ2 - θ3) - 3.84615384615385*cos(θ2 - θ3)), -V2*V3*(-0.769230769230769*sin(θ2 - θ3) + 3.84615384615385*cos(θ2 - θ3)) - V3*V5*(1.46341463414634*sin(θ3 - θ5) + 3.17073170731707*cos(θ3 - θ5)) - V3*V6*(1.92307692307692*sin(θ3 - θ6) + 9.61538461538461*cos(θ3 - θ6)), 0, -V3*V5*(-1.46341463414634*sin(θ3 - θ5) - 3.17073170731707*cos(θ3 - θ5)), -V3*V6*(-1.92307692307692*sin(θ3 - θ6) - 9.61538461538461*cos(θ3 - θ6)), -V3*(-3.84615384615385*sin(θ2 - θ3) - 0.769230769230769*cos(θ2 - θ3)), -V2*(-3.84615384615385*sin(θ2 - θ3) - 0.769230769230769*cos(θ2 - θ3)) - 8.31144465290807*V3 - V5*(3.17073170731707*sin(θ3 - θ5) - 1.46341463414634*cos(θ3 - θ5)) - V6*(9.61538461538461*sin(θ3 - θ6) - 1.92307692307692*cos(θ3 - θ6)), 0, -V3*(3.17073170731707*sin(θ3 - θ5) - 1.46341463414634*cos(θ3 - θ5)), -V3*(9.61538461538461*sin(θ3 - θ6) - 1.92307692307692*cos(θ3 - θ6))], [-V2*V4*(4.0*sin(θ2 - θ4) - 8.0*cos(θ2 - θ4)), 0, -V1*V4*(1.17647058823529*sin(θ4) + 4.70588235294118*cos(θ4)) - V2*V4*(-4.0*sin(θ2 - θ4) + 8.0*cos(θ2 - θ4)) - V4*V5*(1.0*sin(θ4 - θ5) + 2.0*cos(θ4 - θ5)), -V4*V5*(-1.0*sin(θ4 - θ5) - 2.0*cos(θ4 - θ5)), 0, -V4*(-8.0*sin(θ2 - θ4) - 4.0*cos(θ2 - θ4)), 0, -V1*(4.70588235294118*sin(θ4) - 1.17647058823529*cos(θ4)) - V2*(-8.0*sin(θ2 - θ4) - 4.0*cos(θ2 - θ4)) - 12.3529411764706*V4 - V5*(2.0*sin(θ4 - θ5) - 1.0*cos(θ4 - θ5)), -V4*(2.0*sin(θ4 - θ5) - 1.0*cos(θ4 - θ5)), 0], [-V2*V5*(1.0*sin(θ2 - θ5) - 3.0*cos(θ2 - θ5)), -V3*V5*(1.46341463414634*sin(θ3 - θ5) - 3.17073170731707*cos(θ3 - θ5)), -V4*V5*(1.0*sin(θ4 - θ5) - 2.0*cos(θ4 - θ5)), -V1*V5*(0.829875518672199*sin(θ5) + 3.11203319502075*cos(θ5)) - V2*V5*(-1.0*sin(θ2 - θ5) + 3.0*cos(θ2 - θ5)) - V3*V5*(-1.46341463414634*sin(θ3 - θ5) + 3.17073170731707*cos(θ3 - θ5)) - V4*V5*(-1.0*sin(θ4 - θ5) + 2.0*cos(θ4 - θ5)) - V5*V6*(1.0*sin(θ5 - θ6) + 3.0*cos(θ5 - θ6)), -V5*V6*(-1.0*sin(θ5 - θ6) - 3.0*cos(θ5 - θ6)), -V5*(-3.0*sin(θ2 - θ5) - 1.0*cos(θ2 - θ5)), -V5*(-3.17073170731707*sin(θ3 - θ5) - 1.46341463414634*cos(θ3 - θ5)), -V5*(-2.0*sin(θ4 - θ5) - 1.0*cos(θ4 - θ5)), -V1*(3.11203319502075*sin(θ5) - 0.829875518672199*cos(θ5)) - V2*(-3.0*sin(θ2 - θ5) - 1.0*cos(θ2 - θ5)) - V3*(-3.17073170731707*sin(θ3 - θ5) - 1.46341463414634*cos(θ3 - θ5)) - V4*(-2.0*sin(θ4 - θ5) - 1.0*cos(θ4 - θ5)) - 10.5865803056371*V5 - V6*(3.0*sin(θ5 - θ6) - 1.0*cos(θ5 - θ6)), -V5*(3.0*sin(θ5 - θ6) - 1.0*cos(θ5 - θ6))], [-V2*V6*(1.55902004454343*sin(θ2 - θ6) - 4.4543429844098*cos(θ2 - θ6)), -V3*V6*(1.92307692307692*sin(θ3 - θ6) - 9.61538461538461*cos(θ3 - θ6)), 0, -V5*V6*(1.0*sin(θ5 - θ6) - 3.0*cos(θ5 - θ6)), -V2*V6*(-1.55902004454343*sin(θ2 - θ6) + 4.4543429844098*cos(θ2 - θ6)) - V3*V6*(-1.92307692307692*sin(θ3 - θ6) + 9.61538461538461*cos(θ3 - θ6)) - V5*V6*(-1.0*sin(θ5 - θ6) + 3.0*cos(θ5 - θ6)), -V6*(-4.4543429844098*sin(θ2 - θ6) - 1.55902004454343*cos(θ2 - θ6)), -V6*(-9.61538461538461*sin(θ3 - θ6) - 1.92307692307692*cos(θ3 - θ6)), 0, -V6*(-3.0*sin(θ5 - θ6) - 1.0*cos(θ5 - θ6)), -V2*(-4.4543429844098*sin(θ2 - θ6) - 1.55902004454343*cos(θ2 - θ6)) - V3*(-9.61538461538461*sin(θ3 - θ6) - 1.92307692307692*cos(θ3 - θ6)) - V5*(-3.0*sin(θ5 - θ6) - 1.0*cos(θ5 - θ6)) - 8.96419393524071*V6], [-V1*V2*(4.0*sin(θ2) - 2.0*cos(θ2)) - V2*V3*(3.84615384615385*sin(θ2 - θ3) - 0.769230769230769*cos(θ2 - θ3)) - V2*V4*(8.0*sin(θ2 - θ4) - 4.0*cos(θ2 - θ4)) - V2*V5*(3.0*sin(θ2 - θ5) - 1.0*cos(θ2 - θ5)) - V2*V6*(4.4543429844098*sin(θ2 - θ6) - 1.55902004454343*cos(θ2 - θ6)), -V2*V3*(-3.84615384615385*sin(θ2 - θ3) + 0.769230769230769*cos(θ2 - θ3)), -V2*V4*(-8.0*sin(θ2 - θ4) + 4.0*cos(θ2 - θ4)), -V2*V5*(-3.0*sin(θ2 - θ5) + 1.0*cos(θ2 - θ5)), -V2*V6*(-4.4543429844098*sin(θ2 - θ6) + 1.55902004454343*cos(θ2 - θ6)), -V1*(-2.0*sin(θ2) - 4.0*cos(θ2)) - 46.3909936611273*V2 - V3*(-0.769230769230769*sin(θ2 - θ3) - 3.84615384615385*cos(θ2 - θ3)) - V4*(-4.0*sin(θ2 - θ4) - 8.0*cos(θ2 - θ4)) - V5*(-1.0*sin(θ2 - θ5) - 3.0*cos(θ2 - θ5)) - V6*(-1.55902004454343*sin(θ2 - θ6) - 4.4543429844098*cos(θ2 - θ6)), -V2*(-0.769230769230769*sin(θ2 - θ3) - 3.84615384615385*cos(θ2 - θ3)), -V2*(-4.0*sin(θ2 - θ4) - 8.0*cos(θ2 - θ4)), -V2*(-1.0*sin(θ2 - θ5) - 3.0*cos(θ2 - θ5)), -V2*(-1.55902004454343*sin(θ2 - θ6) - 4.4543429844098*cos(θ2 - θ6))], [-V2*V3*(3.84615384615385*sin(θ2 - θ3) + 0.769230769230769*cos(θ2 - θ3)), -V2*V3*(-3.84615384615385*sin(θ2 - θ3) - 0.769230769230769*cos(θ2 - θ3)) - V3*V5*(3.17073170731707*sin(θ3 - θ5) - 1.46341463414634*cos(θ3 - θ5)) - V3*V6*(9.61538461538461*sin(θ3 - θ6) - 1.92307692307692*cos(θ3 - θ6)), 0, -V3*V5*(-3.17073170731707*sin(θ3 - θ5) + 1.46341463414634*cos(θ3 - θ5)), -V3*V6*(-9.61538461538461*sin(θ3 - θ6) + 1.92307692307692*cos(θ3 - θ6)), -V3*(0.769230769230769*sin(θ2 - θ3) - 3.84615384615385*cos(θ2 - θ3)), -V2*(0.769230769230769*sin(θ2 - θ3) - 3.84615384615385*cos(θ2 - θ3)) - 33.1345403377111*V3 - V5*(-1.46341463414634*sin(θ3 - θ5) - 3.17073170731707*cos(θ3 - θ5)) - V6*(-1.92307692307692*sin(θ3 - θ6) - 9.61538461538461*cos(θ3 - θ6)), 0, -V3*(-1.46341463414634*sin(θ3 - θ5) - 3.17073170731707*cos(θ3 - θ5)), -V3*(-1.92307692307692*sin(θ3 - θ6) - 9.61538461538461*cos(θ3 - θ6))], [-V2*V4*(8.0*sin(θ2 - θ4) + 4.0*cos(θ2 - θ4)), 0, -V1*V4*(4.70588235294118*sin(θ4) - 1.17647058823529*cos(θ4)) - V2*V4*(-8.0*sin(θ2 - θ4) - 4.0*cos(θ2 - θ4)) - V4*V5*(2.0*sin(θ4 - θ5) - 1.0*cos(θ4 - θ5)), -V4*V5*(-2.0*sin(θ4 - θ5) + 1.0*cos(θ4 - θ5)), 0, -V4*(4.0*sin(θ2 - θ4) - 8.0*cos(θ2 - θ4)), 0, -V1*(-1.17647058823529*sin(θ4) - 4.70588235294118*cos(θ4)) - V2*(4.0*sin(θ2 - θ4) - 8.0*cos(θ2 - θ4)) - 29.2717647058824*V4 - V5*(-1.0*sin(θ4 - θ5) - 2.0*cos(θ4 - θ5)), -V4*(-1.0*sin(θ4 - θ5) - 2.0*cos(θ4 - θ5)), 0], [-V2*V5*(3.0*sin(θ2 - θ5) + 1.0*cos(θ2 - θ5)), -V3*V5*(3.17073170731707*sin(θ3 - θ5) + 1.46341463414634*cos(θ3 - θ5)), -V4*V5*(2.0*sin(θ4 - θ5) + 1.0*cos(θ4 - θ5)), -V1*V5*(3.11203319502075*sin(θ5) - 0.829875518672199*cos(θ5)) - V2*V5*(-3.0*sin(θ2 - θ5) - 1.0*cos(θ2 - θ5)) - V3*V5*(-3.17073170731707*sin(θ3 - θ5) - 1.46341463414634*cos(θ3 - θ5)) - V4*V5*(-2.0*sin(θ4 - θ5) - 1.0*cos(θ4 - θ5)) - V5*V6*(3.0*sin(θ5 - θ6) - 1.0*cos(θ5 - θ6)), -V5*V6*(-3.0*sin(θ5 - θ6) + 1.0*cos(θ5 - θ6)), -V5*(1.0*sin(θ2 - θ5) - 3.0*cos(θ2 - θ5)), -V5*(1.46341463414634*sin(θ3 - θ5) - 3.17073170731707*cos(θ3 - θ5)), -V5*(1.0*sin(θ4 - θ5) - 2.0*cos(θ4 - θ5)), -V1*(-0.829875518672199*sin(θ5) - 3.11203319502075*cos(θ5)) - V2*(1.0*sin(θ2 - θ5) - 3.0*cos(θ2 - θ5)) - V3*(1.46341463414634*sin(θ3 - θ5) - 3.17073170731707*cos(θ3 - θ5)) - V4*(1.0*sin(θ4 - θ5) - 2.0*cos(θ4 - θ5)) - 28.2755298046756*V5 - V6*(-1.0*sin(θ5 - θ6) - 3.0*cos(θ5 - θ6)), -V5*(-1.0*sin(θ5 - θ6) - 3.0*cos(θ5 - θ6))], [-V2*V6*(4.4543429844098*sin(θ2 - θ6) + 1.55902004454343*cos(θ2 - θ6)), -V3*V6*(9.61538461538461*sin(θ3 - θ6) + 1.92307692307692*cos(θ3 - θ6)), 0, -V5*V6*(3.0*sin(θ5 - θ6) + 1.0*cos(θ5 - θ6)), -V2*V6*(-4.4543429844098*sin(θ2 - θ6) - 1.55902004454343*cos(θ2 - θ6)) - V3*V6*(-9.61538461538461*sin(θ3 - θ6) - 1.92307692307692*cos(θ3 - θ6)) - V5*V6*(-3.0*sin(θ5 - θ6) - 1.0*cos(θ5 - θ6)), -V6*(1.55902004454343*sin(θ2 - θ6) - 4.4543429844098*cos(θ2 - θ6)), -V6*(1.92307692307692*sin(θ3 - θ6) - 9.61538461538461*cos(θ3 - θ6)), 0, -V6*(1.0*sin(θ5 - θ6) - 3.0*cos(θ5 - θ6)), -V2*(1.55902004454343*sin(θ2 - θ6) - 4.4543429844098*cos(θ2 - θ6)) - V3*(1.92307692307692*sin(θ3 - θ6) - 9.61538461538461*cos(θ3 - θ6)) - V5*(1.0*sin(θ5 - θ6) - 3.0*cos(θ5 - θ6)) - 34.0094551995888*V6]])
    return B, A


def CarregamentoMaximo3D(Pg2, Pg3):
    a = 0
    b = 2
    while b - a > 0.000000001:
        c = 0.5 * (a + b)
        valor_c = FluxoDeCarga(c, [1.1, 1.1, 1.1, Pg2, Pg3])
        if valor_c:
            a = c
        else:
            b = c
    return a